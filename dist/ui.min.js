const t=(t,e)=>new Promise((i=>setTimeout((()=>i(e)),t)));function e(t,i){if(t&&null!=i)if(Array.isArray(i))for(let l of i)e(t,l);else"string"==typeof i||"number"==typeof i||"boolean"==typeof i?t.appendChild(document.createTextNode(""+i)):t.appendChild(i)}window.sleep=t;const i=new Set;function l(){let t=null;do{t="ui-"+Math.random().toString(16).slice(2)}while(i.has(t)||document.querySelector("#"+t));return i.add(t),t}function s(t,e="div"){let i=document.createElement(e);return i.innerHTML=t,i.firstElementChild}function n(...t){return[...t]}var d=Object.freeze({__proto__:null,sleep:t,append:e,uuid:l,htmlToElement:s,castHtmlElements:n,shuffle:function(t){for(var e,i,l=t.length;0!==l;)i=Math.floor(Math.random()*l),e=t[l-=1],t[l]=t[i],t[i]=e;return t},downloadJson:function(t,e){const i=document.createElement("a");i.href=URL.createObjectURL(new Blob([JSON.stringify(e,null,"\t")],{type:"text/json"})),i.download=t,i.click()},dynamicallyLoadScript:async function(t){return new Promise((e=>{var i=document.createElement("script");i.src=t,i.onreadystatechange=e,i.onload=e,document.head.appendChild(i)}))}});class a extends HTMLElement{self;intervals;constructor(t,{clazz:i=""}={}){super(),this.self=this,e(this,t),i&&this.classList.add(...i.split(" ")),this.remove=this.remove.bind(this),this.intervals=[]}setInterval(t,e){let i=setInterval((()=>{document.body.contains(this)?t():this.intervals.forEach((t=>clearInterval(t)))}),e);return this.intervals.push(i),i}css(t){let e=getComputedStyle(this).getPropertyValue(t);return e||(e=this.style.getPropertyValue(t)),e}cssNumber(t){let e=this.css(t),i=parseFloat(e);return e.endsWith("ms")?i:e.endsWith("s")?1e3*i:i}setCss(t,e){this.style.setProperty(t,""+e)}getCss(t){this.style.getPropertyValue(t)}get visible(){return 0==this.self.hidden}set visible(t){t?this.self.removeAttribute("hidden"):this.self.setAttribute("hidden","")}show(t){return this.self.attach(t),this.self.visible=!0,this}hide(){return this.self.visible=!1,this}remove(){return this.self.parentElement?.removeChild(this.self),this}close(){let t=this.parentElement;for(;!("close"in t);)if(t=t.parentElement,null==t)return this;return t.close(),this}attach(t){return this.self.parentElement||(null==t&&(t=document.body),t.appendChild(this.self)),this}querySelector(t){return super.querySelector(t)}querySelectorAll(t){return super.querySelectorAll(t)}#dropTypeSet=new Set;droppable=!1;dragdata={};makeDraggable(t="element",e=null){this.draggable=!0,t=t.toLowerCase(),null==e&&(e=this),this.dragdata[t]=e,this.addEventListener("dragstart",(e=>{if(null==this.dataset.drag){let t="D_"+Math.floor(1e6*Math.random()).toString(16);this.dataset.drag=t}let i=`[data-drag="${this.dataset.drag}"]`;e.dataTransfer.setData(t,i)}))}#makeDroppable(){this.droppable=!0;let t=t=>{let e=t.dataTransfer.types;for(let i of this.#dropTypeSet)if(e.includes(i))return void t.preventDefault()};this.addEventListener("dragenter",t),this.addEventListener("dragover",t)}onDragOver(t,e){t=t.toLowerCase(),this.droppable||this.#makeDroppable(),this.#dropTypeSet.add(t),this.addEventListener("dragover",(i=>{let l=i.dataTransfer.getData(t);if(""!=l&&l.startsWith("[data-drag")){let s=document.querySelector(l),n=s.dragdata[t];e(n,i,s)}}))}onDrop(t,e){t=t.toLowerCase(),this.droppable||this.#makeDroppable(),this.#dropTypeSet.add(t),this.addEventListener("drop",(i=>{let l=i.dataTransfer.getData(t);if(""!=l&&l.startsWith("[data-drag")){let s=document.querySelector(l),n=s.dragdata[t];e(n,i,s)}}))}}customElements.define("ui-basic",a);class c extends a{constructor(t,e,i={}){super(t),this.setAttribute("ui-button",""),"string"==typeof e?(this.addEventListener("click",(t=>{t.ctrlKey?window.open(e):location.href=e})),this.addEventListener("auxclick",(t=>{1==t.button&&window.open(e)})),this.addEventListener("mousedown",(t=>{1==t.button&&t.preventDefault()}))):e&&this.addEventListener("click",e),i?.style&&this.classList.add(i?.style),i?.color&&this.classList.add(i?.color);let l=i?.icon??this.attributes.getNamedItem("icon")?.value;if(l){let e=document.createElement("i"),i=l.trim().split(" ");i.includes("fa")||i.includes("fab")||i.includes("fas")||e.classList.add("fa"),e.classList.add(...i),this.prepend(e),""==t&&e.classList.add("icon-only")}}}customElements.define("ui-button",c);class u extends a{constructor(t,e){super('<input type="checkbox"/><div><span></span></div>'),this.value=t??"true"==this.attributes.getNamedItem("value")?.value,e&&this.querySelector("input").addEventListener("change",(()=>{e(this.value)}))}get value(){return this.querySelector("input").checked}set value(t){this.querySelector("input").checked=t}}customElements.define("ui-toggle",u);class h extends a{static STYLE={ROW:{parent:"table",wrap:"tr",label:"th",value:"td"},INLINE:{parent:null,wrap:"span",label:"label",value:"span"}};static TRUE_STRINGS=new Set(["true","1","yes","t","y"]);template;changeListeners;formStyle;configuration;value;constructor(t){super(),this.template=t,this.changeListeners=[],this.onChange=this.onChange.bind(this),this.formStyle=h.STYLE.ROW,this.configuration={formatting:{strings:{trim:!0}}},this.value={}}async build(t){this.value=t,this.changeListeners=[];let e=await this.jsonToHtml(this.template,t);return this.innerHTML="",this.append(...e),this.onChange(),this}async onChange(){let t=this.json();this.value=t;for(let e of this.changeListeners)await e(t);this.dispatchEvent(new Event("change"))}json(t=!1){return this._readValue(this,t)}_readValue(t,e=!1){let i={},l=t.querySelectorAll("[data-key]");for(let t of l){if(!e&&t.closest("[hidden]"))continue;let l=i,s=t.dataset.key.split("."),n=s.pop();for(let t of s){if(Array.isArray(l)){let t={};l.push(t),l=t}t.includes("[]")?(t=t.replace("[]",""),l[t]=l[t]??[]):l[t]=l[t]??{},l=l[t]}let d=t["checkbox"==t.type?"checked":"value"];"string"==typeof d&&("text"!=t.type&&"string"!=t.dataset.format||this.configuration.formatting.strings.trim&&(d=d.trim()),"number"!=t.type&&"number"!=t.dataset.format||(d=parseFloat(d)),"datetime-local"!=t.type&&"datetime"!=t.dataset.format||(d=new Date(d)),"boolean"==t.dataset.format&&(d=h.TRUE_STRINGS.has((d+"").toLowerCase()))),n.includes("[]")&&(n=n.replace("[]",""),l[n]=l[n]??[],l=l[n],n=null),Array.isArray(l)&&(null===n?n=l.length:(0!=l.length&&null==l[l.length-1][n]||l.push({}),l=l[l.length-1])),l[n]=d}return i}async jsonToHtml(t,e,i="",l={style:this.formStyle}){let s=[],n=Array.isArray(t)?t:[t];for(let t of n){let n;"string"==typeof t?-1==t.indexOf(":")?n={key:null,type:t}:(n={key:t.split(":")[0],type:t.split(":")[1]},null==e&&(e={})):n=t;let d=(n.key?e[n.key]:e)??n.default;s.push(await this.oneItem(n,d,n.key?(i?i+".":"")+n.key:i,l))}if(l.style?.parent){let t=document.createElement(l.style?.parent);return t.append(...s),[t]}return s}_readJsonWithKey(t,e){try{let i=e.split(".");for(let e of i){if(null==t)return null;e.endsWith("[]")?(e=e.substring(0,e.length-2),t=(t=t[e])?.length>0?t[0]:null):t=t[e]}return t}catch(t){return null}}async oneItem(t,e,i,{style:n=h.STYLE.ROW}={}){let d=document.createElement(n.wrap);d.dataset.element=i;let a=async e=>{let a;if(t.key){if(a=document.createElement(n.label),a.innerHTML=t.name??t.key,t.hint){let e=document.createElement("div");e.innerHTML=t.hint,a.append(e)}d.append(a)}let u=document.createElement(n.value);if(u.classList.add("value"),d.append(u),"string"!=typeof t.type&&t.type){if("function"==typeof t.type){let l=t.type;if(l.prototype&&l.prototype.constructor.name){let l=new t.type(e,i,d);l.dataset.key=i,u.append(l)}else{let l=t.type(e,i,d);l.dataset.key=i,u.append(l)}}}else{let n="";switch(t.type){case"header":a.setAttribute("colspan","2"),a.classList.add("header"),u.remove();break;case"description":u.setAttribute("colspan","2"),u.classList.add("description"),u.innerHTML=t.key,a.remove();break;case"hr":u.setAttribute("colspan","2"),u.innerHTML="<hr/>";break;case"checkbox":n+=`<input data-key="${i}" type="checkbox" ${e?"checked":""}/>`,u.innerHTML=n;break;case"boolean":case"toggle":n+=`<ui-toggle data-key="${i}" value="${e??!1}"></ui-toggle>`,u.innerHTML=n;break;case"dropdown":case"select":case"list":let d;n+=`<select data-key="${i}" data-format="${t.format}">`,d=Array.isArray(t.options)?t.options:await t.options(this.value),n+=d.map((t=>`<option \n\t\t\t\t\t\t\t\t${e==(t.value?t.value:t)?"selected":""}\n\t\t\t\t\t\t\t\tvalue="${t.value?t.value:t}">${t.name?t.name:t}</option>`)).join(""),n+="</select>",u.innerHTML=n;break;case"text":n+=`<textarea data-key="${i}">${e??""}</textarea>`,u.innerHTML=n;break;case"number":n+=`<input data-key="${i}" type="number" value="${e??""}"/>`,u.innerHTML=n;break;case"object":case"compound":u.append(...await this.jsonToHtml(t.children,e??{},i));break;case"array":i+="[]";let b=t.style??"INLINE",m=h.STYLE[b],o=document.createElement("div");o.classList.add("array"),o.classList.add(b);let Z=new c("Add",null,{icon:"fa-plus"}),p=async e=>{let l=document.createElement("span");l.classList.add("item"),l.append(...await this.jsonToHtml(t.children,e,i,{style:m})),l.append(new c("",(()=>{l.remove(),this.onChange()}),{icon:"fa-trash",style:"text",color:"error-color"}));let s=l.querySelectorAll("[data-key]");for(let t of s)t.addEventListener("change",this.onChange);o.append(l)};if(Z.addEventListener("click",(async()=>{let e=await p(Array.isArray(t.children)?{}:null);return this.onChange(),e})),Array.isArray(e))for(let t of e)await p(t);u.append(o),u.append(Z);break;case"datetime":{let l=s(`<input data-key="${i}" type="datetime-local" placeholder="${t.placeholder??""}"/>`);l.value=e??(new Date).toISOString().substring(0,16),t.disabled&&l.setAttribute("disabled",""),u.append(l);break}case"string":default:{let n=s(`<input data-key="${i}" type="text" placeholder="${t.placeholder??""}"/>`);if(n.value=e??null,t.disabled&&n.setAttribute("disabled",""),t.options){let i;i=Array.isArray(t.options)?t.options:await t.options(this.value);let s=l(),d=tt.html(`<datalist id="${s}">`+i.map((t=>`<option \n\t\t\t\t\t\t\t\t\t\t${e==(t.value?t.value:t)?"selected":""}\n\t\t\t\t\t\t\t\t\t\tvalue="${t.value?t.value:t}">${t.name?t.name:t}</option>`)).join("")+"</datalist>");u.append(d),n.addEventListener("focus",(()=>n.value="")),n.setAttribute("list",s)}u.append(n);break}}}let b=d.querySelectorAll("[data-key]");for(let t of b)t.addEventListener("change",(t=>{t.stopPropagation(),this.onChange()}));t.afterRender&&t.afterRender(d,this)};if(await a(e),t.hidden&&this.changeListeners.push((e=>{d.hidden=t.hidden(e,d)})),t.redraw){let e=Array.isArray(t.redraw)?t.redraw:[t.redraw];for(let t of e){let e={},l=async l=>{let s=this._readJsonWithKey(l,t),n=JSON.stringify(s);if(e!==n){let t=this._readValue(d),l=this._readJsonWithKey(t,i);d.innerHTML="",await a(l),e=n}};this.changeListeners.push(l)}}return d}}customElements.define("ui-form",h);class b extends a{constructor(t="",i){super(),this.setAttribute("ui-panel",""),this.innerHTML.trim()||(this.innerHTML=`\n\t\t\t\t${i?.header||i?.title?`<header>${i?.title??""}</header>`:""}\n\t\t\t\t<content></content>\n\t\t\t\t${i?.footer||i?.buttons?`<footer>${i?.buttons??""}</footer>`:""}\n\t\t\t`,e(this.content,t)),i?.clazz&&(Array.isArray(i.clazz)?this.classList.add(...i.clazz):this.classList.add(i.clazz))}get content(){return this.querySelector("content")}append(...t){e(this.content,t)}header(...t){e(this.querySelector("header"),t)}footer(...t){e(this.querySelector("footer"),t)}}customElements.define("ui-panel",b);class m extends a{constructor(t,{dismissable:e=!1}={}){super(t),e&&this.addEventListener("mousedown",this.remove)}}customElements.define("ui-splash",m);class o extends m{constructor(t,{title:e="",clazz:i="",buttons:l="",dismissable:s=!0,header:n=!1,footer:d=!1}={}){super("",{dismissable:s}),this.setAttribute("ui-modal","");let a=new b(t,{title:e,clazz:i,buttons:l,header:n,footer:d});a.addEventListener("mousedown",(()=>event.stopPropagation())),a.self=this,this.appendChild(a)}get panel(){return this.querySelector("ui-panel")}close(){return this.self.remove(),this}}customElements.define("ui-modal",o);class Z extends a{constructor(){super(),this.attach()}}function p(t,e=!1){return Array.isArray(t)&&!0===e?t.map(p).join(" "):"object"==typeof t?JSON.stringify(t,null,"\t"):""+t}customElements.define("ui-toaster",Z);class r extends a{constructor(t,{level:e="info"}={}){super(p(t,!0));let i=document.createElement("i"),l={debug:"fa-bug",info:"fa-info-circle",warn:"fa-exclamation-circle",error:"fa-exclamation-triangle",success:"fa-check-circle"}[e];i.classList.add("fa",l),this.prepend(i),document.querySelector("ui-toaster")||new Z;let s=document.querySelector("ui-toaster");this.classList.add(e),s.prepend(this),document.querySelectorAll("ui-toast").length,setTimeout((()=>this.style.marginTop="10px"),10),setTimeout((()=>{this.style.marginTop="-50px",this.style.opacity="0"}),4800),setTimeout((()=>this.remove()),5e3)}}function W(...t){new r(t,{level:"info"})}function X(...t){new r(t,{level:"warn"})}function G(...t){new r(t,{level:"error"})}customElements.define("ui-toast",r);var V=Object.freeze({__proto__:null,popupForm:async function(t,{value:e={},title:i="",submitText:l="Submit",wrapper:s=null,dismissable:n=!0}={}){return new Promise((d=>{let a=new h(t);a.build(e).then((()=>{let t=a;s&&(t=s(a));let e=new o(t,{title:i,buttons:"<ui-cancel></ui-cancel><ui-spacer></ui-spacer>",dismissable:n});e.close=()=>(e.self.remove(),d(null),e),e.panel.footer(new c(l,(()=>{e.self.remove(),d(a.json())}))),e.show()}))}))},info:W,warn:X,error:G});class y extends a{constructor(t,{icon:e="",clazz:i=""}={}){if(super(t,{clazz:i}),this.setAttribute("ui-badge",""),e=e||this.attributes.getNamedItem("icon")?.value){let t=document.createElement("i"),i=e.trim().split(" ");i.includes("fa")||i.includes("fab")||i.includes("fas")||t.classList.add("fa"),t.classList.add(...i),this.prepend(t)}}}customElements.define("ui-badge",y);class L extends a{constructor(){super(),this.innerHTML=this.innerHTML||"Cancel",this.addEventListener("click",this.close.bind(this))}}customElements.define("ui-cancel",L);class I extends a{constructor(t){super(),this.setAttribute("ui-card","");let e=t||this.innerHTML;this.innerHTML='<div class="card"></div>',this.setContent(e)}setContent(t){e(this.querySelector(".card"),t)}async flip(){this.flipped=!this.flipped;let t=this.cssNumber("--duration");return new Promise((e=>setTimeout(e,t)))}get flipped(){return null==this.getAttribute("flipped")}set flipped(t){t?this.removeAttribute("flipped"):this.setAttribute("flipped","")}}function x(t,e,i){var l=void 0===e?null:e,s=function(t,e){var i=atob(t);if(e){for(var l=new Uint8Array(i.length),s=0,n=i.length;s<n;++s)l[s]=i.charCodeAt(s);return String.fromCharCode.apply(null,new Uint16Array(l.buffer))}return i}(t,void 0!==i&&i),n=s.indexOf("\n",10)+1,d=s.substring(n)+(l?"//# sourceMappingURL="+l:""),a=new Blob([d],{type:"application/javascript"});return URL.createObjectURL(a)}customElements.define("ui-card",I);var Y,J,S,F,T=(Y="Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewoJJ3VzZSBzdHJpY3QnOwoKCS8vIEB0cy1ub2NoZWNrCglvbm1lc3NhZ2UgPSAoZXZlbnQpID0+IHsKCQlobGpzLmNvbmZpZ3VyZSh7fSk7CgkJY29uc3QgcmVzdWx0ID0gaGxqcy5oaWdobGlnaHRBdXRvKGV2ZW50LmRhdGEpOwoJCXBvc3RNZXNzYWdlKHJlc3VsdC52YWx1ZSk7Cgl9OwoKCS8qCgkgIEhpZ2hsaWdodC5qcyAxMC4xLjAgKDc0ZGU2ZWFhKQoJICBMaWNlbnNlOiBCU0QtMy1DbGF1c2UKCSAgQ29weXJpZ2h0IChjKSAyMDA2LTIwMjAsIEl2YW4gU2FnYWxhZXYKCSovCgl2YXIgaGxqcz1mdW5jdGlvbigpe2Z1bmN0aW9uIGUobil7T2JqZWN0LmZyZWV6ZShuKTt2YXIgdD0iZnVuY3Rpb24iPT10eXBlb2YgbjtyZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMobikuZm9yRWFjaCgoZnVuY3Rpb24ocil7IU9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKG4scil8fG51bGw9PT1uW3JdfHwib2JqZWN0IiE9dHlwZW9mIG5bcl0mJiJmdW5jdGlvbiIhPXR5cGVvZiBuW3JdfHx0JiYoImNhbGxlciI9PT1yfHwiY2FsbGVlIj09PXJ8fCJhcmd1bWVudHMiPT09cil8fE9iamVjdC5pc0Zyb3plbihuW3JdKXx8ZShuW3JdKTt9KSksbn1jbGFzcyBue2NvbnN0cnVjdG9yKGUpe3ZvaWQgMD09PWUuZGF0YSYmKGUuZGF0YT17fSksdGhpcy5kYXRhPWUuZGF0YTt9aWdub3JlTWF0Y2goKXt0aGlzLmlnbm9yZT0hMDt9fWZ1bmN0aW9uIHQoZSl7cmV0dXJuIGUucmVwbGFjZSgvJi9nLCImYW1wOyIpLnJlcGxhY2UoLzwvZywiJmx0OyIpLnJlcGxhY2UoLz4vZywiJmd0OyIpLnJlcGxhY2UoLyIvZywiJnF1b3Q7IikucmVwbGFjZSgvJy9nLCImI3gyNzsiKX1mdW5jdGlvbiByKGUsLi4ubil7dmFyIHQ9e307Zm9yKGNvbnN0IG4gaW4gZSl0W25dPWVbbl07cmV0dXJuIG4uZm9yRWFjaCgoZnVuY3Rpb24oZSl7Zm9yKGNvbnN0IG4gaW4gZSl0W25dPWVbbl07fSkpLHR9ZnVuY3Rpb24gYShlKXtyZXR1cm4gZS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpfXZhciBpPU9iamVjdC5mcmVlemUoe19fcHJvdG9fXzpudWxsLGVzY2FwZUhUTUw6dCxpbmhlcml0OnIsbm9kZVN0cmVhbTpmdW5jdGlvbihlKXt2YXIgbj1bXTtyZXR1cm4gZnVuY3Rpb24gZSh0LHIpe2Zvcih2YXIgaT10LmZpcnN0Q2hpbGQ7aTtpPWkubmV4dFNpYmxpbmcpMz09PWkubm9kZVR5cGU/cis9aS5ub2RlVmFsdWUubGVuZ3RoOjE9PT1pLm5vZGVUeXBlJiYobi5wdXNoKHtldmVudDoic3RhcnQiLG9mZnNldDpyLG5vZGU6aX0pLHI9ZShpLHIpLGEoaSkubWF0Y2goL2JyfGhyfGltZ3xpbnB1dC8pfHxuLnB1c2goe2V2ZW50OiJzdG9wIixvZmZzZXQ6cixub2RlOml9KSk7cmV0dXJuIHJ9KGUsMCksbn0sbWVyZ2VTdHJlYW1zOmZ1bmN0aW9uKGUsbixyKXt2YXIgaT0wLHM9IiIsbz1bXTtmdW5jdGlvbiBsKCl7cmV0dXJuIGUubGVuZ3RoJiZuLmxlbmd0aD9lWzBdLm9mZnNldCE9PW5bMF0ub2Zmc2V0P2VbMF0ub2Zmc2V0PG5bMF0ub2Zmc2V0P2U6bjoic3RhcnQiPT09blswXS5ldmVudD9lOm46ZS5sZW5ndGg/ZTpufWZ1bmN0aW9uIGMoZSl7cys9IjwiK2EoZSkrW10ubWFwLmNhbGwoZS5hdHRyaWJ1dGVzLChmdW5jdGlvbihlKXtyZXR1cm4gIiAiK2Uubm9kZU5hbWUrJz0iJyt0KGUudmFsdWUpKyciJ30pKS5qb2luKCIiKSsiPiI7fWZ1bmN0aW9uIHUoZSl7cys9IjwvIithKGUpKyI+Ijt9ZnVuY3Rpb24gZChlKXsoInN0YXJ0Ij09PWUuZXZlbnQ/Yzp1KShlLm5vZGUpO31mb3IoO2UubGVuZ3RofHxuLmxlbmd0aDspe3ZhciBnPWwoKTtpZihzKz10KHIuc3Vic3RyaW5nKGksZ1swXS5vZmZzZXQpKSxpPWdbMF0ub2Zmc2V0LGc9PT1lKXtvLnJldmVyc2UoKS5mb3JFYWNoKHUpO2Rve2QoZy5zcGxpY2UoMCwxKVswXSksZz1sKCk7fXdoaWxlKGc9PT1lJiZnLmxlbmd0aCYmZ1swXS5vZmZzZXQ9PT1pKTtvLnJldmVyc2UoKS5mb3JFYWNoKGMpO31lbHNlICJzdGFydCI9PT1nWzBdLmV2ZW50P28ucHVzaChnWzBdLm5vZGUpOm8ucG9wKCksZChnLnNwbGljZSgwLDEpWzBdKTt9cmV0dXJuIHMrdChyLnN1YnN0cihpKSl9fSk7Y29uc3Qgcz0iPC9zcGFuPiIsbz1lPT4hIWUua2luZDtjbGFzcyBse2NvbnN0cnVjdG9yKGUsbil7dGhpcy5idWZmZXI9IiIsdGhpcy5jbGFzc1ByZWZpeD1uLmNsYXNzUHJlZml4LGUud2Fsayh0aGlzKTt9YWRkVGV4dChlKXt0aGlzLmJ1ZmZlcis9dChlKTt9b3Blbk5vZGUoZSl7aWYoIW8oZSkpcmV0dXJuO2xldCBuPWUua2luZDtlLnN1Ymxhbmd1YWdlfHwobj1gJHt0aGlzLmNsYXNzUHJlZml4fSR7bn1gKSx0aGlzLnNwYW4obik7fWNsb3NlTm9kZShlKXtvKGUpJiYodGhpcy5idWZmZXIrPXMpO312YWx1ZSgpe3JldHVybiB0aGlzLmJ1ZmZlcn1zcGFuKGUpe3RoaXMuYnVmZmVyKz1gPHNwYW4gY2xhc3M9IiR7ZX0iPmA7fX1jbGFzcyBje2NvbnN0cnVjdG9yKCl7dGhpcy5yb290Tm9kZT17Y2hpbGRyZW46W119LHRoaXMuc3RhY2s9W3RoaXMucm9vdE5vZGVdO31nZXQgdG9wKCl7cmV0dXJuIHRoaXMuc3RhY2tbdGhpcy5zdGFjay5sZW5ndGgtMV19Z2V0IHJvb3QoKXtyZXR1cm4gdGhpcy5yb290Tm9kZX1hZGQoZSl7dGhpcy50b3AuY2hpbGRyZW4ucHVzaChlKTt9b3Blbk5vZGUoZSl7Y29uc3Qgbj17a2luZDplLGNoaWxkcmVuOltdfTt0aGlzLmFkZChuKSx0aGlzLnN0YWNrLnB1c2gobik7fWNsb3NlTm9kZSgpe2lmKHRoaXMuc3RhY2subGVuZ3RoPjEpcmV0dXJuIHRoaXMuc3RhY2sucG9wKCl9Y2xvc2VBbGxOb2Rlcygpe2Zvcig7dGhpcy5jbG9zZU5vZGUoKTspO310b0pTT04oKXtyZXR1cm4gSlNPTi5zdHJpbmdpZnkodGhpcy5yb290Tm9kZSxudWxsLDQpfXdhbGsoZSl7cmV0dXJuIHRoaXMuY29uc3RydWN0b3IuX3dhbGsoZSx0aGlzLnJvb3ROb2RlKX1zdGF0aWMgX3dhbGsoZSxuKXtyZXR1cm4gInN0cmluZyI9PXR5cGVvZiBuP2UuYWRkVGV4dChuKTpuLmNoaWxkcmVuJiYoZS5vcGVuTm9kZShuKSxuLmNoaWxkcmVuLmZvckVhY2gobj0+dGhpcy5fd2FsayhlLG4pKSxlLmNsb3NlTm9kZShuKSksZX1zdGF0aWMgX2NvbGxhcHNlKGUpeyJzdHJpbmciIT10eXBlb2YgZSYmZS5jaGlsZHJlbiYmKGUuY2hpbGRyZW4uZXZlcnkoZT0+InN0cmluZyI9PXR5cGVvZiBlKT9lLmNoaWxkcmVuPVtlLmNoaWxkcmVuLmpvaW4oIiIpXTplLmNoaWxkcmVuLmZvckVhY2goZT0+e2MuX2NvbGxhcHNlKGUpO30pKTt9fWNsYXNzIHUgZXh0ZW5kcyBje2NvbnN0cnVjdG9yKGUpe3N1cGVyKCksdGhpcy5vcHRpb25zPWU7fWFkZEtleXdvcmQoZSxuKXsiIiE9PWUmJih0aGlzLm9wZW5Ob2RlKG4pLHRoaXMuYWRkVGV4dChlKSx0aGlzLmNsb3NlTm9kZSgpKTt9YWRkVGV4dChlKXsiIiE9PWUmJnRoaXMuYWRkKGUpO31hZGRTdWJsYW5ndWFnZShlLG4pe2NvbnN0IHQ9ZS5yb290O3Qua2luZD1uLHQuc3VibGFuZ3VhZ2U9ITAsdGhpcy5hZGQodCk7fXRvSFRNTCgpe3JldHVybiBuZXcgbCh0aGlzLHRoaXMub3B0aW9ucykudmFsdWUoKX1maW5hbGl6ZSgpe3JldHVybiAhMH19ZnVuY3Rpb24gZChlKXtyZXR1cm4gZT8ic3RyaW5nIj09dHlwZW9mIGU/ZTplLnNvdXJjZTpudWxsfWNvbnN0IGc9IigtPykoXFxiMFt4WF1bYS1mQS1GMC05XSt8KFxcYlxcZCsoXFwuXFxkKik/fFxcLlxcZCspKFtlRV1bLStdP1xcZCspPykiLGg9e2JlZ2luOiJcXFxcW1xcc1xcU10iLHJlbGV2YW5jZTowfSxmPXtjbGFzc05hbWU6InN0cmluZyIsYmVnaW46IiciLGVuZDoiJyIsaWxsZWdhbDoiXFxuIixjb250YWluczpbaF19LHA9e2NsYXNzTmFtZToic3RyaW5nIixiZWdpbjonIicsZW5kOiciJyxpbGxlZ2FsOiJcXG4iLGNvbnRhaW5zOltoXX0sYj17YmVnaW46L1xiKGF8YW58dGhlfGFyZXxJJ218aXNuJ3R8ZG9uJ3R8ZG9lc24ndHx3b24ndHxidXR8anVzdHxzaG91bGR8cHJldHR5fHNpbXBseXxlbm91Z2h8Z29ubmF8Z29pbmd8d3RmfHNvfHN1Y2h8d2lsbHx5b3V8eW91cnx0aGV5fGxpa2V8bW9yZSlcYi99LG09ZnVuY3Rpb24oZSxuLHQ9e30pe3ZhciBhPXIoe2NsYXNzTmFtZToiY29tbWVudCIsYmVnaW46ZSxlbmQ6bixjb250YWluczpbXX0sdCk7cmV0dXJuIGEuY29udGFpbnMucHVzaChiKSxhLmNvbnRhaW5zLnB1c2goe2NsYXNzTmFtZToiZG9jdGFnIixiZWdpbjoiKD86VE9ET3xGSVhNRXxOT1RFfEJVR3xPUFRJTUlaRXxIQUNLfFhYWCk6IixyZWxldmFuY2U6MH0pLGF9LHY9bSgiLy8iLCIkIikseD1tKCIvXFwqIiwiXFwqLyIpLEU9bSgiIyIsIiQiKTt2YXIgXz1PYmplY3QuZnJlZXplKHtfX3Byb3RvX186bnVsbCxJREVOVF9SRToiW2EtekEtWl1cXHcqIixVTkRFUlNDT1JFX0lERU5UX1JFOiJbYS16QS1aX11cXHcqIixOVU1CRVJfUkU6IlxcYlxcZCsoXFwuXFxkKyk/IixDX05VTUJFUl9SRTpnLEJJTkFSWV9OVU1CRVJfUkU6IlxcYigwYlswMV0rKSIsUkVfU1RBUlRFUlNfUkU6IiF8IT18IT09fCV8JT18JnwmJnwmPXxcXCp8XFwqPXxcXCt8XFwrPXwsfC18LT18Lz18L3w6fDt8PDx8PDw9fDw9fDx8PT09fD09fD18Pj4+PXw+Pj18Pj18Pj4+fD4+fD58XFw/fFxcW3xcXHt8XFwofFxcXnxcXF49fFxcfHxcXHw9fFxcfFxcfHx+IixTSEVCQU5HOihlPXt9KT0+e2NvbnN0IG49L14jIVsgXSpcLy87cmV0dXJuIGUuYmluYXJ5JiYoZS5iZWdpbj1mdW5jdGlvbiguLi5lKXtyZXR1cm4gZS5tYXAoZT0+ZChlKSkuam9pbigiIil9KG4sLy4qXGIvLGUuYmluYXJ5LC9cYi4qLykpLHIoe2NsYXNzTmFtZToibWV0YSIsYmVnaW46bixlbmQ6LyQvLHJlbGV2YW5jZTowLCJvbjpiZWdpbiI6KGUsbik9PnswIT09ZS5pbmRleCYmbi5pZ25vcmVNYXRjaCgpO319LGUpfSxCQUNLU0xBU0hfRVNDQVBFOmgsQVBPU19TVFJJTkdfTU9ERTpmLFFVT1RFX1NUUklOR19NT0RFOnAsUEhSQVNBTF9XT1JEU19NT0RFOmIsQ09NTUVOVDptLENfTElORV9DT01NRU5UX01PREU6dixDX0JMT0NLX0NPTU1FTlRfTU9ERTp4LEhBU0hfQ09NTUVOVF9NT0RFOkUsTlVNQkVSX01PREU6e2NsYXNzTmFtZToibnVtYmVyIixiZWdpbjoiXFxiXFxkKyhcXC5cXGQrKT8iLHJlbGV2YW5jZTowfSxDX05VTUJFUl9NT0RFOntjbGFzc05hbWU6Im51bWJlciIsYmVnaW46ZyxyZWxldmFuY2U6MH0sQklOQVJZX05VTUJFUl9NT0RFOntjbGFzc05hbWU6Im51bWJlciIsYmVnaW46IlxcYigwYlswMV0rKSIscmVsZXZhbmNlOjB9LENTU19OVU1CRVJfTU9ERTp7Y2xhc3NOYW1lOiJudW1iZXIiLGJlZ2luOiJcXGJcXGQrKFxcLlxcZCspPyglfGVtfGV4fGNofHJlbXx2d3x2aHx2bWlufHZtYXh8Y218bW18aW58cHR8cGN8cHh8ZGVnfGdyYWR8cmFkfHR1cm58c3xtc3xIenxrSHp8ZHBpfGRwY218ZHBweCk/IixyZWxldmFuY2U6MH0sUkVHRVhQX01PREU6e2JlZ2luOi8oPz1cL1teL1xuXSpcLykvLGNvbnRhaW5zOlt7Y2xhc3NOYW1lOiJyZWdleHAiLGJlZ2luOi9cLy8sZW5kOi9cL1tnaW11eV0qLyxpbGxlZ2FsOi9cbi8sY29udGFpbnM6W2gse2JlZ2luOi9cWy8sZW5kOi9cXS8scmVsZXZhbmNlOjAsY29udGFpbnM6W2hdfV19XX0sVElUTEVfTU9ERTp7Y2xhc3NOYW1lOiJ0aXRsZSIsYmVnaW46IlthLXpBLVpdXFx3KiIscmVsZXZhbmNlOjB9LFVOREVSU0NPUkVfVElUTEVfTU9ERTp7Y2xhc3NOYW1lOiJ0aXRsZSIsYmVnaW46IlthLXpBLVpfXVxcdyoiLHJlbGV2YW5jZTowfSxNRVRIT0RfR1VBUkQ6e2JlZ2luOiJcXC5cXHMqW2EtekEtWl9dXFx3KiIscmVsZXZhbmNlOjB9LEVORF9TQU1FX0FTX0JFR0lOOmZ1bmN0aW9uKGUpe3JldHVybiBPYmplY3QuYXNzaWduKGUseyJvbjpiZWdpbiI6KGUsbik9PntuLmRhdGEuX2JlZ2luTWF0Y2g9ZVsxXTt9LCJvbjplbmQiOihlLG4pPT57bi5kYXRhLl9iZWdpbk1hdGNoIT09ZVsxXSYmbi5pZ25vcmVNYXRjaCgpO319KX19KSxOPSJvZiBhbmQgZm9yIGluIG5vdCBvciBpZiB0aGVuIi5zcGxpdCgiICIpO2Z1bmN0aW9uIHcoZSxuKXtyZXR1cm4gbj8rbjpmdW5jdGlvbihlKXtyZXR1cm4gTi5pbmNsdWRlcyhlLnRvTG93ZXJDYXNlKCkpfShlKT8wOjF9Y29uc3QgUj10LHk9cix7bm9kZVN0cmVhbTprLG1lcmdlU3RyZWFtczpPfT1pLE09U3ltYm9sKCJub21hdGNoIik7cmV0dXJuIGZ1bmN0aW9uKHQpe3ZhciBhPVtdLGk9e30scz17fSxvPVtdLGw9ITAsYz0vKF4oPFtePl0rPnxcdHwpK3xcbikvZ20sZz0iQ291bGQgbm90IGZpbmQgdGhlIGxhbmd1YWdlICd7fScsIGRpZCB5b3UgZm9yZ2V0IHRvIGxvYWQvaW5jbHVkZSBhIGxhbmd1YWdlIG1vZHVsZT8iO2NvbnN0IGg9e2Rpc2FibGVBdXRvZGV0ZWN0OiEwLG5hbWU6IlBsYWluIHRleHQiLGNvbnRhaW5zOltdfTt2YXIgZj17bm9IaWdobGlnaHRSZTovXihuby0/aGlnaGxpZ2h0KSQvaSxsYW5ndWFnZURldGVjdFJlOi9cYmxhbmcoPzp1YWdlKT8tKFtcdy1dKylcYi9pLGNsYXNzUHJlZml4OiJobGpzLSIsdGFiUmVwbGFjZTpudWxsLHVzZUJSOiExLGxhbmd1YWdlczpudWxsLF9fZW1pdHRlcjp1fTtmdW5jdGlvbiBwKGUpe3JldHVybiBmLm5vSGlnaGxpZ2h0UmUudGVzdChlKX1mdW5jdGlvbiBiKGUsbix0LHIpe3ZhciBhPXtjb2RlOm4sbGFuZ3VhZ2U6ZX07UygiYmVmb3JlOmhpZ2hsaWdodCIsYSk7dmFyIGk9YS5yZXN1bHQ/YS5yZXN1bHQ6bShhLmxhbmd1YWdlLGEuY29kZSx0LHIpO3JldHVybiBpLmNvZGU9YS5jb2RlLFMoImFmdGVyOmhpZ2hsaWdodCIsaSksaX1mdW5jdGlvbiBtKGUsdCxhLHMpe3ZhciBvPXQ7ZnVuY3Rpb24gYyhlLG4pe3ZhciB0PUUuY2FzZV9pbnNlbnNpdGl2ZT9uWzBdLnRvTG93ZXJDYXNlKCk6blswXTtyZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUua2V5d29yZHMsdCkmJmUua2V5d29yZHNbdF19ZnVuY3Rpb24gdSgpe251bGwhPXkuc3ViTGFuZ3VhZ2U/ZnVuY3Rpb24oKXtpZigiIiE9PUEpe3ZhciBlPW51bGw7aWYoInN0cmluZyI9PXR5cGVvZiB5LnN1Ykxhbmd1YWdlKXtpZighaVt5LnN1Ykxhbmd1YWdlXSlyZXR1cm4gdm9pZCBPLmFkZFRleHQoQSk7ZT1tKHkuc3ViTGFuZ3VhZ2UsQSwhMCxrW3kuc3ViTGFuZ3VhZ2VdKSxrW3kuc3ViTGFuZ3VhZ2VdPWUudG9wO31lbHNlIGU9dihBLHkuc3ViTGFuZ3VhZ2UubGVuZ3RoP3kuc3ViTGFuZ3VhZ2U6bnVsbCk7eS5yZWxldmFuY2U+MCYmKEkrPWUucmVsZXZhbmNlKSxPLmFkZFN1Ymxhbmd1YWdlKGUuZW1pdHRlcixlLmxhbmd1YWdlKTt9fSgpOmZ1bmN0aW9uKCl7aWYoIXkua2V5d29yZHMpcmV0dXJuIHZvaWQgTy5hZGRUZXh0KEEpO2xldCBlPTA7eS5rZXl3b3JkUGF0dGVyblJlLmxhc3RJbmRleD0wO2xldCBuPXkua2V5d29yZFBhdHRlcm5SZS5leGVjKEEpLHQ9IiI7Zm9yKDtuOyl7dCs9QS5zdWJzdHJpbmcoZSxuLmluZGV4KTtjb25zdCByPWMoeSxuKTtpZihyKXtjb25zdFtlLGFdPXI7Ty5hZGRUZXh0KHQpLHQ9IiIsSSs9YSxPLmFkZEtleXdvcmQoblswXSxlKTt9ZWxzZSB0Kz1uWzBdO2U9eS5rZXl3b3JkUGF0dGVyblJlLmxhc3RJbmRleCxuPXkua2V5d29yZFBhdHRlcm5SZS5leGVjKEEpO310Kz1BLnN1YnN0cihlKSxPLmFkZFRleHQodCk7fSgpLEE9IiI7fWZ1bmN0aW9uIGgoZSl7cmV0dXJuIGUuY2xhc3NOYW1lJiZPLm9wZW5Ob2RlKGUuY2xhc3NOYW1lKSx5PU9iamVjdC5jcmVhdGUoZSx7cGFyZW50Ont2YWx1ZTp5fX0pfWZ1bmN0aW9uIHAoZSl7cmV0dXJuIDA9PT15Lm1hdGNoZXIucmVnZXhJbmRleD8oQSs9ZVswXSwxKTooTD0hMCwwKX12YXIgYj17fTtmdW5jdGlvbiB4KHQscil7dmFyIGk9ciYmclswXTtpZihBKz10LG51bGw9PWkpcmV0dXJuIHUoKSwwO2lmKCJiZWdpbiI9PT1iLnR5cGUmJiJlbmQiPT09ci50eXBlJiZiLmluZGV4PT09ci5pbmRleCYmIiI9PT1pKXtpZihBKz1vLnNsaWNlKHIuaW5kZXgsci5pbmRleCsxKSwhbCl7Y29uc3Qgbj1FcnJvcigiMCB3aWR0aCBtYXRjaCByZWdleCIpO3Rocm93IG4ubGFuZ3VhZ2VOYW1lPWUsbi5iYWRSdWxlPWIucnVsZSxufXJldHVybiAxfWlmKGI9ciwiYmVnaW4iPT09ci50eXBlKXJldHVybiBmdW5jdGlvbihlKXt2YXIgdD1lWzBdLHI9ZS5ydWxlO2NvbnN0IGE9bmV3IG4ociksaT1bci5fX2JlZm9yZUJlZ2luLHJbIm9uOmJlZ2luIl1dO2Zvcihjb25zdCBuIG9mIGkpaWYobiYmKG4oZSxhKSxhLmlnbm9yZSkpcmV0dXJuIHAodCk7cmV0dXJuIHImJnIuZW5kU2FtZUFzQmVnaW4mJihyLmVuZFJlPVJlZ0V4cCh0LnJlcGxhY2UoL1stL1xcXiQqKz8uKCl8W1xde31dL2csIlxcJCYiKSwibSIpKSxyLnNraXA/QSs9dDooci5leGNsdWRlQmVnaW4mJihBKz10KSx1KCksci5yZXR1cm5CZWdpbnx8ci5leGNsdWRlQmVnaW58fChBPXQpKSxoKHIpLHIucmV0dXJuQmVnaW4/MDp0Lmxlbmd0aH0ocik7aWYoImlsbGVnYWwiPT09ci50eXBlJiYhYSl7Y29uc3QgZT1FcnJvcignSWxsZWdhbCBsZXhlbWUgIicraSsnIiBmb3IgbW9kZSAiJysoeS5jbGFzc05hbWV8fCI8dW5uYW1lZD4iKSsnIicpO3Rocm93IGUubW9kZT15LGV9aWYoImVuZCI9PT1yLnR5cGUpe3ZhciBzPWZ1bmN0aW9uKGUpe3ZhciB0PWVbMF0scj1vLnN1YnN0cihlLmluZGV4KSxhPWZ1bmN0aW9uIGUodCxyLGEpe2xldCBpPWZ1bmN0aW9uKGUsbil7dmFyIHQ9ZSYmZS5leGVjKG4pO3JldHVybiB0JiYwPT09dC5pbmRleH0odC5lbmRSZSxhKTtpZihpKXtpZih0WyJvbjplbmQiXSl7Y29uc3QgZT1uZXcgbih0KTt0WyJvbjplbmQiXShyLGUpLGUuaWdub3JlJiYoaT0hMSk7fWlmKGkpe2Zvcig7dC5lbmRzUGFyZW50JiZ0LnBhcmVudDspdD10LnBhcmVudDtyZXR1cm4gdH19aWYodC5lbmRzV2l0aFBhcmVudClyZXR1cm4gZSh0LnBhcmVudCxyLGEpfSh5LGUscik7aWYoIWEpcmV0dXJuIE07dmFyIGk9eTtpLnNraXA/QSs9dDooaS5yZXR1cm5FbmR8fGkuZXhjbHVkZUVuZHx8KEErPXQpLHUoKSxpLmV4Y2x1ZGVFbmQmJihBPXQpKTtkb3t5LmNsYXNzTmFtZSYmTy5jbG9zZU5vZGUoKSx5LnNraXB8fHkuc3ViTGFuZ3VhZ2V8fChJKz15LnJlbGV2YW5jZSkseT15LnBhcmVudDt9d2hpbGUoeSE9PWEucGFyZW50KTtyZXR1cm4gYS5zdGFydHMmJihhLmVuZFNhbWVBc0JlZ2luJiYoYS5zdGFydHMuZW5kUmU9YS5lbmRSZSksaChhLnN0YXJ0cykpLGkucmV0dXJuRW5kPzA6dC5sZW5ndGh9KHIpO2lmKHMhPT1NKXJldHVybiBzfWlmKCJpbGxlZ2FsIj09PXIudHlwZSYmIiI9PT1pKXJldHVybiAxO2lmKEI+MWU1JiZCPjMqci5pbmRleCl0aHJvdyBFcnJvcigicG90ZW50aWFsIGluZmluaXRlIGxvb3AsIHdheSBtb3JlIGl0ZXJhdGlvbnMgdGhhbiBtYXRjaGVzIik7cmV0dXJuIEErPWksaS5sZW5ndGh9dmFyIEU9VChlKTtpZighRSl0aHJvdyBjb25zb2xlLmVycm9yKGcucmVwbGFjZSgie30iLGUpKSxFcnJvcignVW5rbm93biBsYW5ndWFnZTogIicrZSsnIicpO3ZhciBfPWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIG4obix0KXtyZXR1cm4gUmVnRXhwKGQobiksIm0iKyhlLmNhc2VfaW5zZW5zaXRpdmU/ImkiOiIiKSsodD8iZyI6IiIpKX1jbGFzcyB0e2NvbnN0cnVjdG9yKCl7dGhpcy5tYXRjaEluZGV4ZXM9e30sdGhpcy5yZWdleGVzPVtdLHRoaXMubWF0Y2hBdD0xLHRoaXMucG9zaXRpb249MDt9YWRkUnVsZShlLG4pe24ucG9zaXRpb249dGhpcy5wb3NpdGlvbisrLHRoaXMubWF0Y2hJbmRleGVzW3RoaXMubWF0Y2hBdF09bix0aGlzLnJlZ2V4ZXMucHVzaChbbixlXSksdGhpcy5tYXRjaEF0Kz1mdW5jdGlvbihlKXtyZXR1cm4gUmVnRXhwKGUudG9TdHJpbmcoKSsifCIpLmV4ZWMoIiIpLmxlbmd0aC0xfShlKSsxO31jb21waWxlKCl7MD09PXRoaXMucmVnZXhlcy5sZW5ndGgmJih0aGlzLmV4ZWM9KCk9Pm51bGwpO2NvbnN0IGU9dGhpcy5yZWdleGVzLm1hcChlPT5lWzFdKTt0aGlzLm1hdGNoZXJSZT1uKGZ1bmN0aW9uKGUsbj0ifCIpe2Zvcih2YXIgdD0vXFsoPzpbXlxcXF1dfFxcLikqXF18XChcPz98XFwoWzEtOV1bMC05XSopfFxcLi8scj0wLGE9IiIsaT0wO2k8ZS5sZW5ndGg7aSsrKXt2YXIgcz1yKz0xLG89ZChlW2ldKTtmb3IoaT4wJiYoYSs9biksYSs9IigiO28ubGVuZ3RoPjA7KXt2YXIgbD10LmV4ZWMobyk7aWYobnVsbD09bCl7YSs9bzticmVha31hKz1vLnN1YnN0cmluZygwLGwuaW5kZXgpLG89by5zdWJzdHJpbmcobC5pbmRleCtsWzBdLmxlbmd0aCksIlxcIj09PWxbMF1bMF0mJmxbMV0/YSs9IlxcIisoK2xbMV0rcyk6KGErPWxbMF0sIigiPT09bFswXSYmcisrKTt9YSs9IikiO31yZXR1cm4gYX0oZSksITApLHRoaXMubGFzdEluZGV4PTA7fWV4ZWMoZSl7dGhpcy5tYXRjaGVyUmUubGFzdEluZGV4PXRoaXMubGFzdEluZGV4O2NvbnN0IG49dGhpcy5tYXRjaGVyUmUuZXhlYyhlKTtpZighbilyZXR1cm4gbnVsbDtjb25zdCB0PW4uZmluZEluZGV4KChlLG4pPT5uPjAmJnZvaWQgMCE9PWUpLHI9dGhpcy5tYXRjaEluZGV4ZXNbdF07cmV0dXJuIG4uc3BsaWNlKDAsdCksT2JqZWN0LmFzc2lnbihuLHIpfX1jbGFzcyBhe2NvbnN0cnVjdG9yKCl7dGhpcy5ydWxlcz1bXSx0aGlzLm11bHRpUmVnZXhlcz1bXSx0aGlzLmNvdW50PTAsdGhpcy5sYXN0SW5kZXg9MCx0aGlzLnJlZ2V4SW5kZXg9MDt9Z2V0TWF0Y2hlcihlKXtpZih0aGlzLm11bHRpUmVnZXhlc1tlXSlyZXR1cm4gdGhpcy5tdWx0aVJlZ2V4ZXNbZV07Y29uc3Qgbj1uZXcgdDtyZXR1cm4gdGhpcy5ydWxlcy5zbGljZShlKS5mb3JFYWNoKChbZSx0XSk9Pm4uYWRkUnVsZShlLHQpKSxuLmNvbXBpbGUoKSx0aGlzLm11bHRpUmVnZXhlc1tlXT1uLG59Y29uc2lkZXJBbGwoKXt0aGlzLnJlZ2V4SW5kZXg9MDt9YWRkUnVsZShlLG4pe3RoaXMucnVsZXMucHVzaChbZSxuXSksImJlZ2luIj09PW4udHlwZSYmdGhpcy5jb3VudCsrO31leGVjKGUpe2NvbnN0IG49dGhpcy5nZXRNYXRjaGVyKHRoaXMucmVnZXhJbmRleCk7bi5sYXN0SW5kZXg9dGhpcy5sYXN0SW5kZXg7Y29uc3QgdD1uLmV4ZWMoZSk7cmV0dXJuIHQmJih0aGlzLnJlZ2V4SW5kZXgrPXQucG9zaXRpb24rMSx0aGlzLnJlZ2V4SW5kZXg9PT10aGlzLmNvdW50JiYodGhpcy5yZWdleEluZGV4PTApKSx0fX1mdW5jdGlvbiBpKGUsbil7Y29uc3QgdD1lLmlucHV0W2UuaW5kZXgtMV0scj1lLmlucHV0W2UuaW5kZXgrZVswXS5sZW5ndGhdOyIuIiE9PXQmJiIuIiE9PXJ8fG4uaWdub3JlTWF0Y2goKTt9aWYoZS5jb250YWlucyYmZS5jb250YWlucy5pbmNsdWRlcygic2VsZiIpKXRocm93IEVycm9yKCJFUlI6IGNvbnRhaW5zIGBzZWxmYCBpcyBub3Qgc3VwcG9ydGVkIGF0IHRoZSB0b3AtbGV2ZWwgb2YgYSBsYW5ndWFnZS4gIFNlZSBkb2N1bWVudGF0aW9uLiIpO3JldHVybiBmdW5jdGlvbiB0KHMsbyl7Y29uc3QgbD1zO2lmKHMuY29tcGlsZWQpcmV0dXJuIGw7cy5jb21waWxlZD0hMCxzLl9fYmVmb3JlQmVnaW49bnVsbCxzLmtleXdvcmRzPXMua2V5d29yZHN8fHMuYmVnaW5LZXl3b3JkcztsZXQgYz1udWxsO2lmKCJvYmplY3QiPT10eXBlb2Ygcy5rZXl3b3JkcyYmKGM9cy5rZXl3b3Jkcy4kcGF0dGVybixkZWxldGUgcy5rZXl3b3Jkcy4kcGF0dGVybikscy5rZXl3b3JkcyYmKHMua2V5d29yZHM9ZnVuY3Rpb24oZSxuKXt2YXIgdD17fTtyZXR1cm4gInN0cmluZyI9PXR5cGVvZiBlP3IoImtleXdvcmQiLGUpOk9iamVjdC5rZXlzKGUpLmZvckVhY2goKGZ1bmN0aW9uKG4pe3IobixlW25dKTt9KSksdDtmdW5jdGlvbiByKGUscil7biYmKHI9ci50b0xvd2VyQ2FzZSgpKSxyLnNwbGl0KCIgIikuZm9yRWFjaCgoZnVuY3Rpb24obil7dmFyIHI9bi5zcGxpdCgifCIpO3RbclswXV09W2UsdyhyWzBdLHJbMV0pXTt9KSk7fX0ocy5rZXl3b3JkcyxlLmNhc2VfaW5zZW5zaXRpdmUpKSxzLmxleGVtZXMmJmMpdGhyb3cgRXJyb3IoIkVSUjogUHJlZmVyIGBrZXl3b3Jkcy4kcGF0dGVybmAgdG8gYG1vZGUubGV4ZW1lc2AsIEJPVEggYXJlIG5vdCBhbGxvd2VkLiAoc2VlIG1vZGUgcmVmZXJlbmNlKSAiKTtyZXR1cm4gbC5rZXl3b3JkUGF0dGVyblJlPW4ocy5sZXhlbWVzfHxjfHwvXHcrLywhMCksbyYmKHMuYmVnaW5LZXl3b3JkcyYmKHMuYmVnaW49IlxcYigiK3MuYmVnaW5LZXl3b3Jkcy5zcGxpdCgiICIpLmpvaW4oInwiKSsiKSg/PVxcYnxcXHMpIixzLl9fYmVmb3JlQmVnaW49aSkscy5iZWdpbnx8KHMuYmVnaW49L1xCfFxiLyksbC5iZWdpblJlPW4ocy5iZWdpbikscy5lbmRTYW1lQXNCZWdpbiYmKHMuZW5kPXMuYmVnaW4pLHMuZW5kfHxzLmVuZHNXaXRoUGFyZW50fHwocy5lbmQ9L1xCfFxiLykscy5lbmQmJihsLmVuZFJlPW4ocy5lbmQpKSxsLnRlcm1pbmF0b3JfZW5kPWQocy5lbmQpfHwiIixzLmVuZHNXaXRoUGFyZW50JiZvLnRlcm1pbmF0b3JfZW5kJiYobC50ZXJtaW5hdG9yX2VuZCs9KHMuZW5kPyJ8IjoiIikrby50ZXJtaW5hdG9yX2VuZCkpLHMuaWxsZWdhbCYmKGwuaWxsZWdhbFJlPW4ocy5pbGxlZ2FsKSksdm9pZCAwPT09cy5yZWxldmFuY2UmJihzLnJlbGV2YW5jZT0xKSxzLmNvbnRhaW5zfHwocy5jb250YWlucz1bXSkscy5jb250YWlucz1bXS5jb25jYXQoLi4ucy5jb250YWlucy5tYXAoKGZ1bmN0aW9uKGUpe3JldHVybiBmdW5jdGlvbihlKXtyZXR1cm4gZS52YXJpYW50cyYmIWUuY2FjaGVkX3ZhcmlhbnRzJiYoZS5jYWNoZWRfdmFyaWFudHM9ZS52YXJpYW50cy5tYXAoKGZ1bmN0aW9uKG4pe3JldHVybiByKGUse3ZhcmlhbnRzOm51bGx9LG4pfSkpKSxlLmNhY2hlZF92YXJpYW50cz9lLmNhY2hlZF92YXJpYW50czpmdW5jdGlvbiBlKG4pe3JldHVybiAhIW4mJihuLmVuZHNXaXRoUGFyZW50fHxlKG4uc3RhcnRzKSl9KGUpP3IoZSx7c3RhcnRzOmUuc3RhcnRzP3IoZS5zdGFydHMpOm51bGx9KTpPYmplY3QuaXNGcm96ZW4oZSk/cihlKTplfSgic2VsZiI9PT1lP3M6ZSl9KSkpLHMuY29udGFpbnMuZm9yRWFjaCgoZnVuY3Rpb24oZSl7dChlLGwpO30pKSxzLnN0YXJ0cyYmdChzLnN0YXJ0cyxvKSxsLm1hdGNoZXI9ZnVuY3Rpb24oZSl7Y29uc3Qgbj1uZXcgYTtyZXR1cm4gZS5jb250YWlucy5mb3JFYWNoKGU9Pm4uYWRkUnVsZShlLmJlZ2luLHtydWxlOmUsdHlwZToiYmVnaW4ifSkpLGUudGVybWluYXRvcl9lbmQmJm4uYWRkUnVsZShlLnRlcm1pbmF0b3JfZW5kLHt0eXBlOiJlbmQifSksZS5pbGxlZ2FsJiZuLmFkZFJ1bGUoZS5pbGxlZ2FsLHt0eXBlOiJpbGxlZ2FsIn0pLG59KGwpLGx9KGUpfShFKSxOPSIiLHk9c3x8XyxrPXt9LE89bmV3IGYuX19lbWl0dGVyKGYpOyFmdW5jdGlvbigpe2Zvcih2YXIgZT1bXSxuPXk7biE9PUU7bj1uLnBhcmVudCluLmNsYXNzTmFtZSYmZS51bnNoaWZ0KG4uY2xhc3NOYW1lKTtlLmZvckVhY2goZT0+Ty5vcGVuTm9kZShlKSk7fSgpO3ZhciBBPSIiLEk9MCxTPTAsQj0wLEw9ITE7dHJ5e2Zvcih5Lm1hdGNoZXIuY29uc2lkZXJBbGwoKTs7KXtCKyssTD9MPSExOih5Lm1hdGNoZXIubGFzdEluZGV4PVMseS5tYXRjaGVyLmNvbnNpZGVyQWxsKCkpO2NvbnN0IGU9eS5tYXRjaGVyLmV4ZWMobyk7aWYoIWUpYnJlYWs7Y29uc3Qgbj14KG8uc3Vic3RyaW5nKFMsZS5pbmRleCksZSk7Uz1lLmluZGV4K247fXJldHVybiB4KG8uc3Vic3RyKFMpKSxPLmNsb3NlQWxsTm9kZXMoKSxPLmZpbmFsaXplKCksTj1PLnRvSFRNTCgpLHtyZWxldmFuY2U6SSx2YWx1ZTpOLGxhbmd1YWdlOmUsaWxsZWdhbDohMSxlbWl0dGVyOk8sdG9wOnl9fWNhdGNoKG4pe2lmKG4ubWVzc2FnZSYmbi5tZXNzYWdlLmluY2x1ZGVzKCJJbGxlZ2FsIikpcmV0dXJuIHtpbGxlZ2FsOiEwLGlsbGVnYWxCeTp7bXNnOm4ubWVzc2FnZSxjb250ZXh0Om8uc2xpY2UoUy0xMDAsUysxMDApLG1vZGU6bi5tb2RlfSxzb2ZhcjpOLHJlbGV2YW5jZTowLHZhbHVlOlIobyksZW1pdHRlcjpPfTtpZihsKXJldHVybiB7aWxsZWdhbDohMSxyZWxldmFuY2U6MCx2YWx1ZTpSKG8pLGVtaXR0ZXI6TyxsYW5ndWFnZTplLHRvcDp5LGVycm9yUmFpc2VkOm59O3Rocm93IG59fWZ1bmN0aW9uIHYoZSxuKXtuPW58fGYubGFuZ3VhZ2VzfHxPYmplY3Qua2V5cyhpKTt2YXIgdD1mdW5jdGlvbihlKXtjb25zdCBuPXtyZWxldmFuY2U6MCxlbWl0dGVyOm5ldyBmLl9fZW1pdHRlcihmKSx2YWx1ZTpSKGUpLGlsbGVnYWw6ITEsdG9wOmh9O3JldHVybiBuLmVtaXR0ZXIuYWRkVGV4dChlKSxufShlKSxyPXQ7cmV0dXJuIG4uZmlsdGVyKFQpLmZpbHRlcihJKS5mb3JFYWNoKChmdW5jdGlvbihuKXt2YXIgYT1tKG4sZSwhMSk7YS5sYW5ndWFnZT1uLGEucmVsZXZhbmNlPnIucmVsZXZhbmNlJiYocj1hKSxhLnJlbGV2YW5jZT50LnJlbGV2YW5jZSYmKHI9dCx0PWEpO30pKSxyLmxhbmd1YWdlJiYodC5zZWNvbmRfYmVzdD1yKSx0fWZ1bmN0aW9uIHgoZSl7cmV0dXJuIGYudGFiUmVwbGFjZXx8Zi51c2VCUj9lLnJlcGxhY2UoYyxlPT4iXG4iPT09ZT9mLnVzZUJSPyI8YnI+IjplOmYudGFiUmVwbGFjZT9lLnJlcGxhY2UoL1x0L2csZi50YWJSZXBsYWNlKTplKTplfWZ1bmN0aW9uIEUoZSl7bGV0IG49bnVsbDtjb25zdCB0PWZ1bmN0aW9uKGUpe3ZhciBuPWUuY2xhc3NOYW1lKyIgIjtuKz1lLnBhcmVudE5vZGU/ZS5wYXJlbnROb2RlLmNsYXNzTmFtZToiIjtjb25zdCB0PWYubGFuZ3VhZ2VEZXRlY3RSZS5leGVjKG4pO2lmKHQpe3ZhciByPVQodFsxXSk7cmV0dXJuIHJ8fChjb25zb2xlLndhcm4oZy5yZXBsYWNlKCJ7fSIsdFsxXSkpLGNvbnNvbGUud2FybigiRmFsbGluZyBiYWNrIHRvIG5vLWhpZ2hsaWdodCBtb2RlIGZvciB0aGlzIGJsb2NrLiIsZSkpLHI/dFsxXToibm8taGlnaGxpZ2h0In1yZXR1cm4gbi5zcGxpdCgvXHMrLykuZmluZChlPT5wKGUpfHxUKGUpKX0oZSk7aWYocCh0KSlyZXR1cm47UygiYmVmb3JlOmhpZ2hsaWdodEJsb2NrIix7YmxvY2s6ZSxsYW5ndWFnZTp0fSksZi51c2VCUj8obj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKSkuaW5uZXJIVE1MPWUuaW5uZXJIVE1MLnJlcGxhY2UoL1xuL2csIiIpLnJlcGxhY2UoLzxiclsgL10qPi9nLCJcbiIpOm49ZTtjb25zdCByPW4udGV4dENvbnRlbnQsYT10P2IodCxyLCEwKTp2KHIpLGk9ayhuKTtpZihpLmxlbmd0aCl7Y29uc3QgZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTtlLmlubmVySFRNTD1hLnZhbHVlLGEudmFsdWU9TyhpLGsoZSkscik7fWEudmFsdWU9eChhLnZhbHVlKSxTKCJhZnRlcjpoaWdobGlnaHRCbG9jayIse2Jsb2NrOmUscmVzdWx0OmF9KSxlLmlubmVySFRNTD1hLnZhbHVlLGUuY2xhc3NOYW1lPWZ1bmN0aW9uKGUsbix0KXt2YXIgcj1uP3Nbbl06dCxhPVtlLnRyaW0oKV07cmV0dXJuIGUubWF0Y2goL1xiaGxqc1xiLyl8fGEucHVzaCgiaGxqcyIpLGUuaW5jbHVkZXMocil8fGEucHVzaChyKSxhLmpvaW4oIiAiKS50cmltKCl9KGUuY2xhc3NOYW1lLHQsYS5sYW5ndWFnZSksZS5yZXN1bHQ9e2xhbmd1YWdlOmEubGFuZ3VhZ2UscmU6YS5yZWxldmFuY2UscmVsYXZhbmNlOmEucmVsZXZhbmNlfSxhLnNlY29uZF9iZXN0JiYoZS5zZWNvbmRfYmVzdD17bGFuZ3VhZ2U6YS5zZWNvbmRfYmVzdC5sYW5ndWFnZSxyZTphLnNlY29uZF9iZXN0LnJlbGV2YW5jZSxyZWxhdmFuY2U6YS5zZWNvbmRfYmVzdC5yZWxldmFuY2V9KTt9Y29uc3QgTj0oKT0+e2lmKCFOLmNhbGxlZCl7Ti5jYWxsZWQ9ITA7dmFyIGU9ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgicHJlIGNvZGUiKTthLmZvckVhY2guY2FsbChlLEUpO319O2Z1bmN0aW9uIFQoZSl7cmV0dXJuIGU9KGV8fCIiKS50b0xvd2VyQ2FzZSgpLGlbZV18fGlbc1tlXV19ZnVuY3Rpb24gQShlLHtsYW5ndWFnZU5hbWU6bn0peyJzdHJpbmciPT10eXBlb2YgZSYmKGU9W2VdKSxlLmZvckVhY2goZT0+e3NbZV09bjt9KTt9ZnVuY3Rpb24gSShlKXt2YXIgbj1UKGUpO3JldHVybiBuJiYhbi5kaXNhYmxlQXV0b2RldGVjdH1mdW5jdGlvbiBTKGUsbil7dmFyIHQ9ZTtvLmZvckVhY2goKGZ1bmN0aW9uKGUpe2VbdF0mJmVbdF0obik7fSkpO31PYmplY3QuYXNzaWduKHQse2hpZ2hsaWdodDpiLGhpZ2hsaWdodEF1dG86dixmaXhNYXJrdXA6eCxoaWdobGlnaHRCbG9jazpFLGNvbmZpZ3VyZTpmdW5jdGlvbihlKXtmPXkoZixlKTt9LGluaXRIaWdobGlnaHRpbmc6Tixpbml0SGlnaGxpZ2h0aW5nT25Mb2FkOmZ1bmN0aW9uKCl7d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoIkRPTUNvbnRlbnRMb2FkZWQiLE4sITEpO30scmVnaXN0ZXJMYW5ndWFnZTpmdW5jdGlvbihlLG4pe3ZhciByPW51bGw7dHJ5e3I9bih0KTt9Y2F0Y2gobil7aWYoY29uc29sZS5lcnJvcigiTGFuZ3VhZ2UgZGVmaW5pdGlvbiBmb3IgJ3t9JyBjb3VsZCBub3QgYmUgcmVnaXN0ZXJlZC4iLnJlcGxhY2UoInt9IixlKSksIWwpdGhyb3cgbjtjb25zb2xlLmVycm9yKG4pLHI9aDt9ci5uYW1lfHwoci5uYW1lPWUpLGlbZV09cixyLnJhd0RlZmluaXRpb249bi5iaW5kKG51bGwsdCksci5hbGlhc2VzJiZBKHIuYWxpYXNlcyx7bGFuZ3VhZ2VOYW1lOmV9KTt9LGxpc3RMYW5ndWFnZXM6ZnVuY3Rpb24oKXtyZXR1cm4gT2JqZWN0LmtleXMoaSl9LGdldExhbmd1YWdlOlQscmVnaXN0ZXJBbGlhc2VzOkEscmVxdWlyZUxhbmd1YWdlOmZ1bmN0aW9uKGUpe3ZhciBuPVQoZSk7aWYobilyZXR1cm4gbjt0aHJvdyBFcnJvcigiVGhlICd7fScgbGFuZ3VhZ2UgaXMgcmVxdWlyZWQsIGJ1dCBub3QgbG9hZGVkLiIucmVwbGFjZSgie30iLGUpKX0sYXV0b0RldGVjdGlvbjpJLGluaGVyaXQ6eSxhZGRQbHVnaW46ZnVuY3Rpb24oZSl7by5wdXNoKGUpO319KSx0LmRlYnVnTW9kZT1mdW5jdGlvbigpe2w9ITE7fSx0LnNhZmVNb2RlPWZ1bmN0aW9uKCl7bD0hMDt9LHQudmVyc2lvblN0cmluZz0iMTAuMS4wIjtmb3IoY29uc3QgbiBpbiBfKSJvYmplY3QiPT10eXBlb2YgX1tuXSYmZShfW25dKTtyZXR1cm4gT2JqZWN0LmFzc2lnbih0LF8pLHR9KHt9KX0oKTsib2JqZWN0Ij09dHlwZW9mIGV4cG9ydHMmJiJ1bmRlZmluZWQiIT10eXBlb2YgbW9kdWxlJiYobW9kdWxlLmV4cG9ydHM9aGxqcyk7CglobGpzLnJlZ2lzdGVyTGFuZ3VhZ2UoImNzcyIsZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oZSl7dmFyIG49e2JlZ2luOi8oPzpbQS1aXF9cLlwtXSt8LS1bYS16QS1aMC05Xy1dKylccyo6LyxyZXR1cm5CZWdpbjohMCxlbmQ6IjsiLGVuZHNXaXRoUGFyZW50OiEwLGNvbnRhaW5zOlt7Y2xhc3NOYW1lOiJhdHRyaWJ1dGUiLGJlZ2luOi9cUy8sZW5kOiI6IixleGNsdWRlRW5kOiEwLHN0YXJ0czp7ZW5kc1dpdGhQYXJlbnQ6ITAsZXhjbHVkZUVuZDohMCxjb250YWluczpbe2JlZ2luOi9bXHctXStcKC8scmV0dXJuQmVnaW46ITAsY29udGFpbnM6W3tjbGFzc05hbWU6ImJ1aWx0X2luIixiZWdpbjovW1x3LV0rL30se2JlZ2luOi9cKC8sZW5kOi9cKS8sY29udGFpbnM6W2UuQVBPU19TVFJJTkdfTU9ERSxlLlFVT1RFX1NUUklOR19NT0RFLGUuQ1NTX05VTUJFUl9NT0RFXX1dfSxlLkNTU19OVU1CRVJfTU9ERSxlLlFVT1RFX1NUUklOR19NT0RFLGUuQVBPU19TVFJJTkdfTU9ERSxlLkNfQkxPQ0tfQ09NTUVOVF9NT0RFLHtjbGFzc05hbWU6Im51bWJlciIsYmVnaW46IiNbMC05QS1GYS1mXSsifSx7Y2xhc3NOYW1lOiJtZXRhIixiZWdpbjoiIWltcG9ydGFudCJ9XX19XX07cmV0dXJuIHtuYW1lOiJDU1MiLGNhc2VfaW5zZW5zaXRpdmU6ITAsaWxsZWdhbDovWz1cL3wnXCRdLyxjb250YWluczpbZS5DX0JMT0NLX0NPTU1FTlRfTU9ERSx7Y2xhc3NOYW1lOiJzZWxlY3Rvci1pZCIsYmVnaW46LyNbQS1aYS16MC05Xy1dKy99LHtjbGFzc05hbWU6InNlbGVjdG9yLWNsYXNzIixiZWdpbjovXC5bQS1aYS16MC05Xy1dKy99LHtjbGFzc05hbWU6InNlbGVjdG9yLWF0dHIiLGJlZ2luOi9cWy8sZW5kOi9cXS8saWxsZWdhbDoiJCIsY29udGFpbnM6W2UuQVBPU19TVFJJTkdfTU9ERSxlLlFVT1RFX1NUUklOR19NT0RFXX0se2NsYXNzTmFtZToic2VsZWN0b3ItcHNldWRvIixiZWdpbjovOig6KT9bYS16QS1aMC05XF9cLVwrXChcKSInLl0rL30se2JlZ2luOiJAKHBhZ2V8Zm9udC1mYWNlKSIsbGV4ZW1lczoiQFthLXotXSsiLGtleXdvcmRzOiJAcGFnZSBAZm9udC1mYWNlIn0se2JlZ2luOiJAIixlbmQ6Ilt7O10iLGlsbGVnYWw6LzovLHJldHVybkJlZ2luOiEwLGNvbnRhaW5zOlt7Y2xhc3NOYW1lOiJrZXl3b3JkIixiZWdpbjovQFwtP1x3W1x3XSooXC1cdyspKi99LHtiZWdpbjovXHMvLGVuZHNXaXRoUGFyZW50OiEwLGV4Y2x1ZGVFbmQ6ITAscmVsZXZhbmNlOjAsa2V5d29yZHM6ImFuZCBvciBub3Qgb25seSIsY29udGFpbnM6W3tiZWdpbjovW2Etei1dKzovLGNsYXNzTmFtZToiYXR0cmlidXRlIn0sZS5BUE9TX1NUUklOR19NT0RFLGUuUVVPVEVfU1RSSU5HX01PREUsZS5DU1NfTlVNQkVSX01PREVdfV19LHtjbGFzc05hbWU6InNlbGVjdG9yLXRhZyIsYmVnaW46IlthLXpBLVotXVthLXpBLVowLTlfLV0qIixyZWxldmFuY2U6MH0se2JlZ2luOiJ7IixlbmQ6In0iLGlsbGVnYWw6L1xTLyxjb250YWluczpbZS5DX0JMT0NLX0NPTU1FTlRfTU9ERSxuXX1dfX19KCkpOwoJaGxqcy5yZWdpc3Rlckxhbmd1YWdlKCJkaWZmIixmdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbihlKXtyZXR1cm4ge25hbWU6IkRpZmYiLGFsaWFzZXM6WyJwYXRjaCJdLGNvbnRhaW5zOlt7Y2xhc3NOYW1lOiJtZXRhIixyZWxldmFuY2U6MTAsdmFyaWFudHM6W3tiZWdpbjovXkBAICtcLVxkKyxcZCsgK1wrXGQrLFxkKyArQEAkL30se2JlZ2luOi9eXCpcKlwqICtcZCssXGQrICtcKlwqXCpcKiQvfSx7YmVnaW46L15cLVwtXC0gK1xkKyxcZCsgK1wtXC1cLVwtJC99XX0se2NsYXNzTmFtZToiY29tbWVudCIsdmFyaWFudHM6W3tiZWdpbjovSW5kZXg6IC8sZW5kOi8kL30se2JlZ2luOi89ezMsfS8sZW5kOi8kL30se2JlZ2luOi9eXC17M30vLGVuZDovJC99LHtiZWdpbjovXlwqezN9IC8sZW5kOi8kL30se2JlZ2luOi9eXCt7M30vLGVuZDovJC99LHtiZWdpbjovXlwqezE1fSQvfV19LHtjbGFzc05hbWU6ImFkZGl0aW9uIixiZWdpbjoiXlxcKyIsZW5kOiIkIn0se2NsYXNzTmFtZToiZGVsZXRpb24iLGJlZ2luOiJeXFwtIixlbmQ6IiQifSx7Y2xhc3NOYW1lOiJhZGRpdGlvbiIsYmVnaW46Il5cXCEiLGVuZDoiJCJ9XX19fSgpKTsKCWhsanMucmVnaXN0ZXJMYW5ndWFnZSgiamF2YXNjcmlwdCIsZnVuY3Rpb24oKXtjb25zdCBlPVsiYXMiLCJpbiIsIm9mIiwiaWYiLCJmb3IiLCJ3aGlsZSIsImZpbmFsbHkiLCJ2YXIiLCJuZXciLCJmdW5jdGlvbiIsImRvIiwicmV0dXJuIiwidm9pZCIsImVsc2UiLCJicmVhayIsImNhdGNoIiwiaW5zdGFuY2VvZiIsIndpdGgiLCJ0aHJvdyIsImNhc2UiLCJkZWZhdWx0IiwidHJ5Iiwic3dpdGNoIiwiY29udGludWUiLCJ0eXBlb2YiLCJkZWxldGUiLCJsZXQiLCJ5aWVsZCIsImNvbnN0IiwiY2xhc3MiLCJkZWJ1Z2dlciIsImFzeW5jIiwiYXdhaXQiLCJzdGF0aWMiLCJpbXBvcnQiLCJmcm9tIiwiZXhwb3J0IiwiZXh0ZW5kcyJdLG49WyJ0cnVlIiwiZmFsc2UiLCJudWxsIiwidW5kZWZpbmVkIiwiTmFOIiwiSW5maW5pdHkiXSxhPVtdLmNvbmNhdChbInNldEludGVydmFsIiwic2V0VGltZW91dCIsImNsZWFySW50ZXJ2YWwiLCJjbGVhclRpbWVvdXQiLCJyZXF1aXJlIiwiZXhwb3J0cyIsImV2YWwiLCJpc0Zpbml0ZSIsImlzTmFOIiwicGFyc2VGbG9hdCIsInBhcnNlSW50IiwiZGVjb2RlVVJJIiwiZGVjb2RlVVJJQ29tcG9uZW50IiwiZW5jb2RlVVJJIiwiZW5jb2RlVVJJQ29tcG9uZW50IiwiZXNjYXBlIiwidW5lc2NhcGUiXSxbImFyZ3VtZW50cyIsInRoaXMiLCJzdXBlciIsImNvbnNvbGUiLCJ3aW5kb3ciLCJkb2N1bWVudCIsImxvY2FsU3RvcmFnZSIsIm1vZHVsZSIsImdsb2JhbCJdLFsiSW50bCIsIkRhdGFWaWV3IiwiTnVtYmVyIiwiTWF0aCIsIkRhdGUiLCJTdHJpbmciLCJSZWdFeHAiLCJPYmplY3QiLCJGdW5jdGlvbiIsIkJvb2xlYW4iLCJFcnJvciIsIlN5bWJvbCIsIlNldCIsIk1hcCIsIldlYWtTZXQiLCJXZWFrTWFwIiwiUHJveHkiLCJSZWZsZWN0IiwiSlNPTiIsIlByb21pc2UiLCJGbG9hdDY0QXJyYXkiLCJJbnQxNkFycmF5IiwiSW50MzJBcnJheSIsIkludDhBcnJheSIsIlVpbnQxNkFycmF5IiwiVWludDMyQXJyYXkiLCJGbG9hdDMyQXJyYXkiLCJBcnJheSIsIlVpbnQ4QXJyYXkiLCJVaW50OENsYW1wZWRBcnJheSIsIkFycmF5QnVmZmVyIl0sWyJFdmFsRXJyb3IiLCJJbnRlcm5hbEVycm9yIiwiUmFuZ2VFcnJvciIsIlJlZmVyZW5jZUVycm9yIiwiU3ludGF4RXJyb3IiLCJUeXBlRXJyb3IiLCJVUklFcnJvciJdKTtmdW5jdGlvbiBzKGUpe3JldHVybiByKCIoPz0iLGUsIikiKX1mdW5jdGlvbiByKC4uLmUpe3JldHVybiBlLm1hcChlPT4oZnVuY3Rpb24oZSl7cmV0dXJuIGU/InN0cmluZyI9PXR5cGVvZiBlP2U6ZS5zb3VyY2U6bnVsbH0pKGUpKS5qb2luKCIiKX1yZXR1cm4gZnVuY3Rpb24odCl7dmFyIGk9IltBLVphLXokX11bMC05QS1aYS16JF9dKiIsYz17YmVnaW46LzxbQS1aYS16MC05XFwuXzotXSsvLGVuZDovXC9bQS1aYS16MC05XFwuXzotXSs+fFwvPi99LG89eyRwYXR0ZXJuOiJbQS1aYS16JF9dWzAtOUEtWmEteiRfXSoiLGtleXdvcmQ6ZS5qb2luKCIgIiksbGl0ZXJhbDpuLmpvaW4oIiAiKSxidWlsdF9pbjphLmpvaW4oIiAiKX0sbD17Y2xhc3NOYW1lOiJudW1iZXIiLHZhcmlhbnRzOlt7YmVnaW46IlxcYigwW2JCXVswMV0rKW4/In0se2JlZ2luOiJcXGIoMFtvT11bMC03XSspbj8ifSx7YmVnaW46dC5DX05VTUJFUl9SRSsibj8ifV0scmVsZXZhbmNlOjB9LEU9e2NsYXNzTmFtZToic3Vic3QiLGJlZ2luOiJcXCRcXHsiLGVuZDoiXFx9IixrZXl3b3JkczpvLGNvbnRhaW5zOltdfSxkPXtiZWdpbjoiaHRtbGAiLGVuZDoiIixzdGFydHM6e2VuZDoiYCIscmV0dXJuRW5kOiExLGNvbnRhaW5zOlt0LkJBQ0tTTEFTSF9FU0NBUEUsRV0sc3ViTGFuZ3VhZ2U6InhtbCJ9fSxnPXtiZWdpbjoiY3NzYCIsZW5kOiIiLHN0YXJ0czp7ZW5kOiJgIixyZXR1cm5FbmQ6ITEsY29udGFpbnM6W3QuQkFDS1NMQVNIX0VTQ0FQRSxFXSxzdWJMYW5ndWFnZToiY3NzIn19LHU9e2NsYXNzTmFtZToic3RyaW5nIixiZWdpbjoiYCIsZW5kOiJgIixjb250YWluczpbdC5CQUNLU0xBU0hfRVNDQVBFLEVdfTtFLmNvbnRhaW5zPVt0LkFQT1NfU1RSSU5HX01PREUsdC5RVU9URV9TVFJJTkdfTU9ERSxkLGcsdSxsLHQuUkVHRVhQX01PREVdO3ZhciBiPUUuY29udGFpbnMuY29uY2F0KFt7YmVnaW46L1woLyxlbmQ6L1wpLyxjb250YWluczpbInNlbGYiXS5jb25jYXQoRS5jb250YWlucyxbdC5DX0JMT0NLX0NPTU1FTlRfTU9ERSx0LkNfTElORV9DT01NRU5UX01PREVdKX0sdC5DX0JMT0NLX0NPTU1FTlRfTU9ERSx0LkNfTElORV9DT01NRU5UX01PREVdKSxfPXtjbGFzc05hbWU6InBhcmFtcyIsYmVnaW46L1woLyxlbmQ6L1wpLyxleGNsdWRlQmVnaW46ITAsZXhjbHVkZUVuZDohMCxjb250YWluczpifTtyZXR1cm4ge25hbWU6IkphdmFTY3JpcHQiLGFsaWFzZXM6WyJqcyIsImpzeCIsIm1qcyIsImNqcyJdLGtleXdvcmRzOm8sY29udGFpbnM6W3QuU0hFQkFORyh7YmluYXJ5OiJub2RlIixyZWxldmFuY2U6NX0pLHtjbGFzc05hbWU6Im1ldGEiLHJlbGV2YW5jZToxMCxiZWdpbjovXlxzKlsnIl11c2UgKHN0cmljdHxhc20pWyciXS99LHQuQVBPU19TVFJJTkdfTU9ERSx0LlFVT1RFX1NUUklOR19NT0RFLGQsZyx1LHQuQ19MSU5FX0NPTU1FTlRfTU9ERSx0LkNPTU1FTlQoIi9cXCpcXCoiLCJcXCovIix7cmVsZXZhbmNlOjAsY29udGFpbnM6W3tjbGFzc05hbWU6ImRvY3RhZyIsYmVnaW46IkBbQS1aYS16XSsiLGNvbnRhaW5zOlt7Y2xhc3NOYW1lOiJ0eXBlIixiZWdpbjoiXFx7IixlbmQ6IlxcfSIscmVsZXZhbmNlOjB9LHtjbGFzc05hbWU6InZhcmlhYmxlIixiZWdpbjppKyIoPz1cXHMqKC0pfCQpIixlbmRzUGFyZW50OiEwLHJlbGV2YW5jZTowfSx7YmVnaW46Lyg/PVteXG5dKVxzLyxyZWxldmFuY2U6MH1dfV19KSx0LkNfQkxPQ0tfQ09NTUVOVF9NT0RFLGwse2JlZ2luOnIoL1t7LFxuXVxzKi8scyhyKC8oKChcL1wvLiopfChcL1wqKC58XG4pKlwqXC8pKVxzKikqLyxpKyJcXHMqOiIpKSkscmVsZXZhbmNlOjAsY29udGFpbnM6W3tjbGFzc05hbWU6ImF0dHIiLGJlZ2luOmkrcygiXFxzKjoiKSxyZWxldmFuY2U6MH1dfSx7YmVnaW46IigiK3QuUkVfU1RBUlRFUlNfUkUrInxcXGIoY2FzZXxyZXR1cm58dGhyb3cpXFxiKVxccyoiLGtleXdvcmRzOiJyZXR1cm4gdGhyb3cgY2FzZSIsY29udGFpbnM6W3QuQ19MSU5FX0NPTU1FTlRfTU9ERSx0LkNfQkxPQ0tfQ09NTUVOVF9NT0RFLHQuUkVHRVhQX01PREUse2NsYXNzTmFtZToiZnVuY3Rpb24iLGJlZ2luOiIoXFwoW14oXSooXFwoW14oXSooXFwoW14oXSpcXCkpP1xcKSk/XFwpfCIrdC5VTkRFUlNDT1JFX0lERU5UX1JFKyIpXFxzKj0+IixyZXR1cm5CZWdpbjohMCxlbmQ6Ilxccyo9PiIsY29udGFpbnM6W3tjbGFzc05hbWU6InBhcmFtcyIsdmFyaWFudHM6W3tiZWdpbjp0LlVOREVSU0NPUkVfSURFTlRfUkV9LHtjbGFzc05hbWU6bnVsbCxiZWdpbjovXChccypcKS8sc2tpcDohMH0se2JlZ2luOi9cKC8sZW5kOi9cKS8sZXhjbHVkZUJlZ2luOiEwLGV4Y2x1ZGVFbmQ6ITAsa2V5d29yZHM6byxjb250YWluczpifV19XX0se2JlZ2luOi8sLyxyZWxldmFuY2U6MH0se2NsYXNzTmFtZToiIixiZWdpbjovXHMvLGVuZDovXHMqLyxza2lwOiEwfSx7dmFyaWFudHM6W3tiZWdpbjoiPD4iLGVuZDoiPC8+In0se2JlZ2luOmMuYmVnaW4sZW5kOmMuZW5kfV0sc3ViTGFuZ3VhZ2U6InhtbCIsY29udGFpbnM6W3tiZWdpbjpjLmJlZ2luLGVuZDpjLmVuZCxza2lwOiEwLGNvbnRhaW5zOlsic2VsZiJdfV19XSxyZWxldmFuY2U6MH0se2NsYXNzTmFtZToiZnVuY3Rpb24iLGJlZ2luS2V5d29yZHM6ImZ1bmN0aW9uIixlbmQ6L1x7LyxleGNsdWRlRW5kOiEwLGNvbnRhaW5zOlt0LmluaGVyaXQodC5USVRMRV9NT0RFLHtiZWdpbjppfSksX10saWxsZWdhbDovXFt8JS99LHtiZWdpbjovXCRbKC5dL30sdC5NRVRIT0RfR1VBUkQse2NsYXNzTmFtZToiY2xhc3MiLGJlZ2luS2V5d29yZHM6ImNsYXNzIixlbmQ6L1t7Oz1dLyxleGNsdWRlRW5kOiEwLGlsbGVnYWw6L1s6IlxbXF1dLyxjb250YWluczpbe2JlZ2luS2V5d29yZHM6ImV4dGVuZHMifSx0LlVOREVSU0NPUkVfVElUTEVfTU9ERV19LHtiZWdpbktleXdvcmRzOiJjb25zdHJ1Y3RvciIsZW5kOi9cey8sZXhjbHVkZUVuZDohMH0se2JlZ2luOiIoZ2V0fHNldClcXHMrKD89IitpKyJcXCgpIixlbmQ6L3svLGtleXdvcmRzOiJnZXQgc2V0Iixjb250YWluczpbdC5pbmhlcml0KHQuVElUTEVfTU9ERSx7YmVnaW46aX0pLHtiZWdpbjovXChcKS99LF9dfV0saWxsZWdhbDovIyg/ISEpL319fSgpKTsKCWhsanMucmVnaXN0ZXJMYW5ndWFnZSgianNvbiIsZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24obil7dmFyIGU9e2xpdGVyYWw6InRydWUgZmFsc2UgbnVsbCJ9LGk9W24uQ19MSU5FX0NPTU1FTlRfTU9ERSxuLkNfQkxPQ0tfQ09NTUVOVF9NT0RFXSx0PVtuLlFVT1RFX1NUUklOR19NT0RFLG4uQ19OVU1CRVJfTU9ERV0sYT17ZW5kOiIsIixlbmRzV2l0aFBhcmVudDohMCxleGNsdWRlRW5kOiEwLGNvbnRhaW5zOnQsa2V5d29yZHM6ZX0sbD17YmVnaW46InsiLGVuZDoifSIsY29udGFpbnM6W3tjbGFzc05hbWU6ImF0dHIiLGJlZ2luOi8iLyxlbmQ6LyIvLGNvbnRhaW5zOltuLkJBQ0tTTEFTSF9FU0NBUEVdLGlsbGVnYWw6IlxcbiJ9LG4uaW5oZXJpdChhLHtiZWdpbjovOi99KV0uY29uY2F0KGkpLGlsbGVnYWw6IlxcUyJ9LHM9e2JlZ2luOiJcXFsiLGVuZDoiXFxdIixjb250YWluczpbbi5pbmhlcml0KGEpXSxpbGxlZ2FsOiJcXFMifTtyZXR1cm4gdC5wdXNoKGwscyksaS5mb3JFYWNoKChmdW5jdGlvbihuKXt0LnB1c2gobik7fSkpLHtuYW1lOiJKU09OIixjb250YWluczp0LGtleXdvcmRzOmUsaWxsZWdhbDoiXFxTIn19fSgpKTsKCWhsanMucmVnaXN0ZXJMYW5ndWFnZSgieG1sIixmdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbihlKXt2YXIgbj17Y2xhc3NOYW1lOiJzeW1ib2wiLGJlZ2luOiImW2Etel0rO3wmI1swLTldKzt8JiN4W2EtZjAtOV0rOyJ9LGE9e2JlZ2luOiJcXHMiLGNvbnRhaW5zOlt7Y2xhc3NOYW1lOiJtZXRhLWtleXdvcmQiLGJlZ2luOiIjP1thLXpfXVthLXoxLTlfLV0rIixpbGxlZ2FsOiJcXG4ifV19LHM9ZS5pbmhlcml0KGEse2JlZ2luOiJcXCgiLGVuZDoiXFwpIn0pLHQ9ZS5pbmhlcml0KGUuQVBPU19TVFJJTkdfTU9ERSx7Y2xhc3NOYW1lOiJtZXRhLXN0cmluZyJ9KSxpPWUuaW5oZXJpdChlLlFVT1RFX1NUUklOR19NT0RFLHtjbGFzc05hbWU6Im1ldGEtc3RyaW5nIn0pLGM9e2VuZHNXaXRoUGFyZW50OiEwLGlsbGVnYWw6LzwvLHJlbGV2YW5jZTowLGNvbnRhaW5zOlt7Y2xhc3NOYW1lOiJhdHRyIixiZWdpbjoiW0EtWmEtejAtOVxcLl86LV0rIixyZWxldmFuY2U6MH0se2JlZ2luOi89XHMqLyxyZWxldmFuY2U6MCxjb250YWluczpbe2NsYXNzTmFtZToic3RyaW5nIixlbmRzUGFyZW50OiEwLHZhcmlhbnRzOlt7YmVnaW46LyIvLGVuZDovIi8sY29udGFpbnM6W25dfSx7YmVnaW46LycvLGVuZDovJy8sY29udGFpbnM6W25dfSx7YmVnaW46L1teXHMiJz08PmBdKy99XX1dfV19O3JldHVybiB7bmFtZToiSFRNTCwgWE1MIixhbGlhc2VzOlsiaHRtbCIsInhodG1sIiwicnNzIiwiYXRvbSIsInhqYiIsInhzZCIsInhzbCIsInBsaXN0Iiwid3NmIiwic3ZnIl0sY2FzZV9pbnNlbnNpdGl2ZTohMCxjb250YWluczpbe2NsYXNzTmFtZToibWV0YSIsYmVnaW46IjwhW2Etel0iLGVuZDoiPiIscmVsZXZhbmNlOjEwLGNvbnRhaW5zOlthLGksdCxzLHtiZWdpbjoiXFxbIixlbmQ6IlxcXSIsY29udGFpbnM6W3tjbGFzc05hbWU6Im1ldGEiLGJlZ2luOiI8IVthLXpdIixlbmQ6Ij4iLGNvbnRhaW5zOlthLHMsaSx0XX1dfV19LGUuQ09NTUVOVCgiXHgzYyEtLSIsIi0tXHgzZSIse3JlbGV2YW5jZToxMH0pLHtiZWdpbjoiPFxcIVxcW0NEQVRBXFxbIixlbmQ6IlxcXVxcXT4iLHJlbGV2YW5jZToxMH0sbix7Y2xhc3NOYW1lOiJtZXRhIixiZWdpbjovPFw/eG1sLyxlbmQ6L1w/Pi8scmVsZXZhbmNlOjEwfSx7Y2xhc3NOYW1lOiJ0YWciLGJlZ2luOiI8c3R5bGUoPz1cXHN8PikiLGVuZDoiPiIsa2V5d29yZHM6e25hbWU6InN0eWxlIn0sY29udGFpbnM6W2NdLHN0YXJ0czp7ZW5kOiI8L3N0eWxlPiIscmV0dXJuRW5kOiEwLHN1Ykxhbmd1YWdlOlsiY3NzIiwieG1sIl19fSx7Y2xhc3NOYW1lOiJ0YWciLGJlZ2luOiI8c2NyaXB0KD89XFxzfD4pIixlbmQ6Ij4iLGtleXdvcmRzOntuYW1lOiJzY3JpcHQifSxjb250YWluczpbY10sc3RhcnRzOntlbmQ6IjxcL3NjcmlwdD4iLHJldHVybkVuZDohMCxzdWJMYW5ndWFnZTpbImphdmFzY3JpcHQiLCJoYW5kbGViYXJzIiwieG1sIl19fSx7Y2xhc3NOYW1lOiJ0YWciLGJlZ2luOiI8Lz8iLGVuZDoiLz8+Iixjb250YWluczpbe2NsYXNzTmFtZToibmFtZSIsYmVnaW46L1teXC8+PFxzXSsvLHJlbGV2YW5jZTowfSxjXX1dfX19KCkpOwoJaGxqcy5yZWdpc3Rlckxhbmd1YWdlKCJtYXJrZG93biIsZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24obil7Y29uc3QgZT17YmVnaW46IjwiLGVuZDoiPiIsc3ViTGFuZ3VhZ2U6InhtbCIscmVsZXZhbmNlOjB9LGE9e2JlZ2luOiJcXFsuKz9cXF1bXFwoXFxbXS4qP1tcXClcXF1dIixyZXR1cm5CZWdpbjohMCxjb250YWluczpbe2NsYXNzTmFtZToic3RyaW5nIixiZWdpbjoiXFxbIixlbmQ6IlxcXSIsZXhjbHVkZUJlZ2luOiEwLHJldHVybkVuZDohMCxyZWxldmFuY2U6MH0se2NsYXNzTmFtZToibGluayIsYmVnaW46IlxcXVxcKCIsZW5kOiJcXCkiLGV4Y2x1ZGVCZWdpbjohMCxleGNsdWRlRW5kOiEwfSx7Y2xhc3NOYW1lOiJzeW1ib2wiLGJlZ2luOiJcXF1cXFsiLGVuZDoiXFxdIixleGNsdWRlQmVnaW46ITAsZXhjbHVkZUVuZDohMH1dLHJlbGV2YW5jZToxMH0saT17Y2xhc3NOYW1lOiJzdHJvbmciLGNvbnRhaW5zOltdLHZhcmlhbnRzOlt7YmVnaW46L197Mn0vLGVuZDovX3syfS99LHtiZWdpbjovXCp7Mn0vLGVuZDovXCp7Mn0vfV19LHM9e2NsYXNzTmFtZToiZW1waGFzaXMiLGNvbnRhaW5zOltdLHZhcmlhbnRzOlt7YmVnaW46L1wqKD8hXCopLyxlbmQ6L1wqL30se2JlZ2luOi9fKD8hXykvLGVuZDovXy8scmVsZXZhbmNlOjB9XX07aS5jb250YWlucy5wdXNoKHMpLHMuY29udGFpbnMucHVzaChpKTt2YXIgYz1bZSxhXTtyZXR1cm4gaS5jb250YWlucz1pLmNvbnRhaW5zLmNvbmNhdChjKSxzLmNvbnRhaW5zPXMuY29udGFpbnMuY29uY2F0KGMpLHtuYW1lOiJNYXJrZG93biIsYWxpYXNlczpbIm1kIiwibWtkb3duIiwibWtkIl0sY29udGFpbnM6W3tjbGFzc05hbWU6InNlY3Rpb24iLHZhcmlhbnRzOlt7YmVnaW46Il4jezEsNn0iLGVuZDoiJCIsY29udGFpbnM6Yz1jLmNvbmNhdChpLHMpfSx7YmVnaW46Iig/PV4uKz9cXG5bPS1dezIsfSQpIixjb250YWluczpbe2JlZ2luOiJeWz0tXSokIn0se2JlZ2luOiJeIixlbmQ6IlxcbiIsY29udGFpbnM6Y31dfV19LGUse2NsYXNzTmFtZToiYnVsbGV0IixiZWdpbjoiXlsgXHRdKihbKistXXwoXFxkK1xcLikpKD89XFxzKykiLGVuZDoiXFxzKyIsZXhjbHVkZUVuZDohMH0saSxzLHtjbGFzc05hbWU6InF1b3RlIixiZWdpbjoiXj5cXHMrIixjb250YWluczpjLGVuZDoiJCJ9LHtjbGFzc05hbWU6ImNvZGUiLHZhcmlhbnRzOlt7YmVnaW46IihgezMsfSkoLnxcXG4pKj9cXDFgKlsgXSoifSx7YmVnaW46Iih+ezMsfSkoLnxcXG4pKj9cXDF+KlsgXSoifSx7YmVnaW46ImBgYCIsZW5kOiJgYGArWyBdKiQifSx7YmVnaW46In5+fiIsZW5kOiJ+fn4rWyBdKiQifSx7YmVnaW46ImAuKz9gIn0se2JlZ2luOiIoPz1eKCB7NH18XFx0KSkiLGNvbnRhaW5zOlt7YmVnaW46Il4oIHs0fXxcXHQpIixlbmQ6IihcXG4pJCJ9XSxyZWxldmFuY2U6MH1dfSx7YmVnaW46Il5bLVxcKl17Myx9IixlbmQ6IiQifSxhLHtiZWdpbjovXlxbW15cbl0rXF06LyxyZXR1cm5CZWdpbjohMCxjb250YWluczpbe2NsYXNzTmFtZToic3ltYm9sIixiZWdpbjovXFsvLGVuZDovXF0vLGV4Y2x1ZGVCZWdpbjohMCxleGNsdWRlRW5kOiEwfSx7Y2xhc3NOYW1lOiJsaW5rIixiZWdpbjovOlxzKi8sZW5kOi8kLyxleGNsdWRlQmVnaW46ITB9XX1dfX19KCkpOwoJaGxqcy5yZWdpc3Rlckxhbmd1YWdlKCJweXRob24iLGZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKGUpe3ZhciBuPXtrZXl3b3JkOiJhbmQgZWxpZiBpcyBnbG9iYWwgYXMgaW4gaWYgZnJvbSByYWlzZSBmb3IgZXhjZXB0IGZpbmFsbHkgcHJpbnQgaW1wb3J0IHBhc3MgcmV0dXJuIGV4ZWMgZWxzZSBicmVhayBub3Qgd2l0aCBjbGFzcyBhc3NlcnQgeWllbGQgdHJ5IHdoaWxlIGNvbnRpbnVlIGRlbCBvciBkZWYgbGFtYmRhIGFzeW5jIGF3YWl0IG5vbmxvY2FsfDEwIixidWlsdF9pbjoiRWxsaXBzaXMgTm90SW1wbGVtZW50ZWQiLGxpdGVyYWw6IkZhbHNlIE5vbmUgVHJ1ZSJ9LGE9e2NsYXNzTmFtZToibWV0YSIsYmVnaW46L14oPj4+fFwuXC5cLikgL30saT17Y2xhc3NOYW1lOiJzdWJzdCIsYmVnaW46L1x7LyxlbmQ6L1x9LyxrZXl3b3JkczpuLGlsbGVnYWw6LyMvfSxzPXtiZWdpbjovXHtcey8scmVsZXZhbmNlOjB9LHI9e2NsYXNzTmFtZToic3RyaW5nIixjb250YWluczpbZS5CQUNLU0xBU0hfRVNDQVBFXSx2YXJpYW50czpbe2JlZ2luOi8odXxiKT9yPycnJy8sZW5kOi8nJycvLGNvbnRhaW5zOltlLkJBQ0tTTEFTSF9FU0NBUEUsYV0scmVsZXZhbmNlOjEwfSx7YmVnaW46Lyh1fGIpP3I/IiIiLyxlbmQ6LyIiIi8sY29udGFpbnM6W2UuQkFDS1NMQVNIX0VTQ0FQRSxhXSxyZWxldmFuY2U6MTB9LHtiZWdpbjovKGZyfHJmfGYpJycnLyxlbmQ6LycnJy8sY29udGFpbnM6W2UuQkFDS1NMQVNIX0VTQ0FQRSxhLHMsaV19LHtiZWdpbjovKGZyfHJmfGYpIiIiLyxlbmQ6LyIiIi8sY29udGFpbnM6W2UuQkFDS1NMQVNIX0VTQ0FQRSxhLHMsaV19LHtiZWdpbjovKHV8cnx1ciknLyxlbmQ6LycvLHJlbGV2YW5jZToxMH0se2JlZ2luOi8odXxyfHVyKSIvLGVuZDovIi8scmVsZXZhbmNlOjEwfSx7YmVnaW46LyhifGJyKScvLGVuZDovJy99LHtiZWdpbjovKGJ8YnIpIi8sZW5kOi8iL30se2JlZ2luOi8oZnJ8cmZ8ZiknLyxlbmQ6LycvLGNvbnRhaW5zOltlLkJBQ0tTTEFTSF9FU0NBUEUscyxpXX0se2JlZ2luOi8oZnJ8cmZ8ZikiLyxlbmQ6LyIvLGNvbnRhaW5zOltlLkJBQ0tTTEFTSF9FU0NBUEUscyxpXX0sZS5BUE9TX1NUUklOR19NT0RFLGUuUVVPVEVfU1RSSU5HX01PREVdfSxsPXtjbGFzc05hbWU6Im51bWJlciIscmVsZXZhbmNlOjAsdmFyaWFudHM6W3tiZWdpbjplLkJJTkFSWV9OVU1CRVJfUkUrIltsTGpKXT8ifSx7YmVnaW46IlxcYigwb1swLTddKylbbExqSl0/In0se2JlZ2luOmUuQ19OVU1CRVJfUkUrIltsTGpKXT8ifV19LHQ9e2NsYXNzTmFtZToicGFyYW1zIix2YXJpYW50czpbe2JlZ2luOi9cKFxzKlwpLyxza2lwOiEwLGNsYXNzTmFtZTpudWxsfSx7YmVnaW46L1woLyxlbmQ6L1wpLyxleGNsdWRlQmVnaW46ITAsZXhjbHVkZUVuZDohMCxjb250YWluczpbInNlbGYiLGEsbCxyLGUuSEFTSF9DT01NRU5UX01PREVdfV19O3JldHVybiBpLmNvbnRhaW5zPVtyLGwsYV0se25hbWU6IlB5dGhvbiIsYWxpYXNlczpbInB5IiwiZ3lwIiwiaXB5dGhvbiJdLGtleXdvcmRzOm4saWxsZWdhbDovKDxcL3wtPnxcPyl8PT4vLGNvbnRhaW5zOlthLGwse2JlZ2luS2V5d29yZHM6ImlmIixyZWxldmFuY2U6MH0scixlLkhBU0hfQ09NTUVOVF9NT0RFLHt2YXJpYW50czpbe2NsYXNzTmFtZToiZnVuY3Rpb24iLGJlZ2luS2V5d29yZHM6ImRlZiJ9LHtjbGFzc05hbWU6ImNsYXNzIixiZWdpbktleXdvcmRzOiJjbGFzcyJ9XSxlbmQ6LzovLGlsbGVnYWw6L1skez07XG4sXS8sY29udGFpbnM6W2UuVU5ERVJTQ09SRV9USVRMRV9NT0RFLHQse2JlZ2luOi8tPi8sZW5kc1dpdGhQYXJlbnQ6ITAsa2V5d29yZHM6Ik5vbmUifV19LHtjbGFzc05hbWU6Im1ldGEiLGJlZ2luOi9eW1x0IF0qQC8sZW5kOi8kL30se2JlZ2luOi9cYihwcmludHxleGVjKVwoL31dfX19KCkpOwoJaGxqcy5yZWdpc3Rlckxhbmd1YWdlKCJ5YW1sIixmdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbihlKXt2YXIgbj0idHJ1ZSBmYWxzZSB5ZXMgbm8gbnVsbCIsYT0iW1xcdyM7Lz86QCY9KyQsLn4qXFwnKClbXFxdXSsiLHM9e2NsYXNzTmFtZToic3RyaW5nIixyZWxldmFuY2U6MCx2YXJpYW50czpbe2JlZ2luOi8nLyxlbmQ6LycvfSx7YmVnaW46LyIvLGVuZDovIi99LHtiZWdpbjovXFMrL31dLGNvbnRhaW5zOltlLkJBQ0tTTEFTSF9FU0NBUEUse2NsYXNzTmFtZToidGVtcGxhdGUtdmFyaWFibGUiLHZhcmlhbnRzOlt7YmVnaW46Int7IixlbmQ6In19In0se2JlZ2luOiIleyIsZW5kOiJ9In1dfV19LGk9ZS5pbmhlcml0KHMse3ZhcmlhbnRzOlt7YmVnaW46LycvLGVuZDovJy99LHtiZWdpbjovIi8sZW5kOi8iL30se2JlZ2luOi9bXlxzLHt9W1xdXSsvfV19KSxsPXtlbmQ6IiwiLGVuZHNXaXRoUGFyZW50OiEwLGV4Y2x1ZGVFbmQ6ITAsY29udGFpbnM6W10sa2V5d29yZHM6bixyZWxldmFuY2U6MH0sdD17YmVnaW46InsiLGVuZDoifSIsY29udGFpbnM6W2xdLGlsbGVnYWw6IlxcbiIscmVsZXZhbmNlOjB9LGc9e2JlZ2luOiJcXFsiLGVuZDoiXFxdIixjb250YWluczpbbF0saWxsZWdhbDoiXFxuIixyZWxldmFuY2U6MH0sYj1be2NsYXNzTmFtZToiYXR0ciIsdmFyaWFudHM6W3tiZWdpbjoiXFx3W1xcdyA6XFwvLi1dKjooPz1bIFx0XXwkKSJ9LHtiZWdpbjonIlxcd1tcXHcgOlxcLy4tXSoiOig/PVsgXHRdfCQpJ30se2JlZ2luOiInXFx3W1xcdyA6XFwvLi1dKic6KD89WyBcdF18JCkifV19LHtjbGFzc05hbWU6Im1ldGEiLGJlZ2luOiJeLS0tcyokIixyZWxldmFuY2U6MTB9LHtjbGFzc05hbWU6InN0cmluZyIsYmVnaW46IltcXHw+XShbMC05XT9bKy1dKT9bIF0qXFxuKCAqKVtcXFMgXStcXG4oXFwyW1xcUyBdK1xcbj8pKiJ9LHtiZWdpbjoiPCVbJT0tXT8iLGVuZDoiWyUtXT8lPiIsc3ViTGFuZ3VhZ2U6InJ1YnkiLGV4Y2x1ZGVCZWdpbjohMCxleGNsdWRlRW5kOiEwLHJlbGV2YW5jZTowfSx7Y2xhc3NOYW1lOiJ0eXBlIixiZWdpbjoiIVxcdyshIithfSx7Y2xhc3NOYW1lOiJ0eXBlIixiZWdpbjoiITwiK2ErIj4ifSx7Y2xhc3NOYW1lOiJ0eXBlIixiZWdpbjoiISIrYX0se2NsYXNzTmFtZToidHlwZSIsYmVnaW46IiEhIithfSx7Y2xhc3NOYW1lOiJtZXRhIixiZWdpbjoiJiIrZS5VTkRFUlNDT1JFX0lERU5UX1JFKyIkIn0se2NsYXNzTmFtZToibWV0YSIsYmVnaW46IlxcKiIrZS5VTkRFUlNDT1JFX0lERU5UX1JFKyIkIn0se2NsYXNzTmFtZToiYnVsbGV0IixiZWdpbjoiXFwtKD89WyBdfCQpIixyZWxldmFuY2U6MH0sZS5IQVNIX0NPTU1FTlRfTU9ERSx7YmVnaW5LZXl3b3JkczpuLGtleXdvcmRzOntsaXRlcmFsOm59fSx7Y2xhc3NOYW1lOiJudW1iZXIiLGJlZ2luOiJcXGJbMC05XXs0fSgtWzAtOV1bMC05XSl7MCwyfShbVHQgXFx0XVswLTldWzAtOV0/KDpbMC05XVswLTldKXsyfSk/KFxcLlswLTldKik/KFsgXFx0XSkqKFp8Wy0rXVswLTldWzAtOV0/KDpbMC05XVswLTldKT8pP1xcYiJ9LHtjbGFzc05hbWU6Im51bWJlciIsYmVnaW46ZS5DX05VTUJFUl9SRSsiXFxiIn0sdCxnLHNdLGM9Wy4uLmJdO3JldHVybiBjLnBvcCgpLGMucHVzaChpKSxsLmNvbnRhaW5zPWMse25hbWU6IllBTUwiLGNhc2VfaW5zZW5zaXRpdmU6ITAsYWxpYXNlczpbInltbCIsIllBTUwiXSxjb250YWluczpifX19KCkpOwoKfSgpKTsKCg==",J=null,S=!1,function(t){return F=F||x(Y,J,S),new Worker(F,t)});class N extends a{constructor(t){super(t),this.setContent(t||this.innerHTML)}preprocess(t){return t}setContent(t){t=this.preprocess(t);let e=new T;e.onmessage=t=>{this.classList.add("hljs"),this.innerHTML=t.data},e.postMessage(t)}}customElements.define("ui-code",N);class R extends a{target;items=[];#attachments=new WeakMap;constructor(t=null){super("<section></section>"),this.hide=this.hide.bind(this),this.hide();for(let t of["click","contextmenu"])this.addEventListener(t,this.hide),this.firstElementChild.addEventListener(t,(t=>{t.stopPropagation()}));t&&this.for(t)}for(t){let e=e=>{e.preventDefault(),this.renderMenu(t,e.pageX,e.pageY)};return t.addEventListener("contextmenu",e),t.setAttribute("context-menu",""),this.#attachments.set(t,e),this}renderMenu(t,e,i){this.target=t;let l=window.innerWidth,s=window.innerHeight,n=e<.75*l,d=i<.5*s;this.style.left=n?e+"px":null,this.style.right=n?null:l-e+"px",this.style.top=d?i+"px":null,this.style.bottom=d?null:s-i+"px";let a=!1;for(let e of this.items)e.element.hidden=e.hide&&e.hide(t),a=a||!e.element.hidden;a&&this.show()}detach(t){let e=this.#attachments.get(t);e&&(t.removeAttribute("context-menu"),t.removeEventListener("contextmenu",e))}addItem(t,e,i){let l=s(`<div>${t}</div>`);return this.items.push({element:l,hide:i}),l.addEventListener("click",(()=>{e(this.target),this.hide()})),this.firstElementChild.appendChild(l),this}addBreak(){return this.firstElementChild.appendChild(s("<hr/>")),this}clearMenuItems(){this.items=[],this.firstElementChild.innerHTML=""}}customElements.define("ui-context",R);class f extends a{#columns=0;#rows=0;constructor(t){super(),this.setAttribute("ui-grid",""),void 0!==t?.padding&&this.setCss("--padding",t?.padding),void 0!==t?.rowGap&&this.setCss("row-gap",t?.rowGap),void 0!==t?.columnGap&&this.setCss("column-gap",t?.columnGap)}get columns(){return this.#columns}set columns(t){this.#columns=t,this.setCss("--columns",t)}get rows(){return this.#rows}set rows(t){this.#columns=t,this.setCss("--rows",t)}put(t,e,i,l=1,s=1){this.rows<e+s-1&&(this.rows=e+s-1),this.columns<i+l-1&&(this.columns=i+l-1),Array.isArray(t)&&((t=new tt.BasicElement(t)).style.display="flex"),t.style.setProperty("grid-area",`${e} / ${i} / span ${s} / span ${l}`),this.append(t)}}customElements.define("ui-grid",f);class v extends a{obj;key;constructor(t,e,i){super(),this.obj=t,this.key=e,this.setAttribute("ui-input","")}get value(){return Reflect.get(this.obj,this.key)}set value(t){Reflect.set(this.obj,this.key,t)}label(t){return new H(this,t,{wrapped:!0})}}class U extends HTMLInputElement{constructor(t,e,i){super(),this.setAttribute("ui-input","")}label(t){return new H(this,t,{wrapped:!0})}}class g extends U{constructor(t,e,i){super(t,e,i),this.type="text",this.value=Reflect.get(t,e)??null,i?.size&&(this.style.width=24*i?.size+"px"),i?.color&&this.style.setProperty("--color",i?.color),i?.placeholder&&this.setAttribute("placeholder",i?.placeholder),this.addEventListener("change",(()=>{let l=this.value;Reflect.set(t,e,l),i?.callback&&i?.callback(l)}))}}customElements.define("ui-stringinput",g,{extends:"input"});class k extends U{constructor(t,e,i){super(t,e,i),this.type="number",this.value=Reflect.get(t,e),i?.size&&(this.style.width=24*i?.size+"px"),i?.color&&this.style.setProperty("--color",i?.color),i?.placeholder&&this.setAttribute("placeholder",i?.placeholder),this.addEventListener("change",(()=>{let l=parseFloat(this.value);Reflect.set(t,e,l),i?.callback&&i?.callback(l)}))}}customElements.define("ui-numberinput",k,{extends:"input"});class C extends HTMLSelectElement{_value=null;obj;key;constructor(t,e,i={options:[]}){super(),this.obj=t,this.key=e,this.setAttribute("ui-input",""),i?.size&&(this.style.width=24*i?.size+"px"),i?.color&&this.style.setProperty("--color",i?.color),i?.placeholder&&this.setAttribute("placeholder",i?.placeholder),this.addEventListener("change",(()=>{let t=this.value;this.setValue(t),i?.callback&&i?.callback(t)})),this.renderOptions(i.options)}getValue(){return Reflect.get(this.obj,this.key)??null}setValue(t){Reflect.set(this.obj,this.key,t)}async renderOptions(t){let e=null;e="function"==typeof t?await t():t;let i=this.getValue();for(let t of e){let e=document.createElement("option");"string"==typeof t?(t==i&&e.setAttribute("selected",""),e.innerText=t):(t.value==i&&e.setAttribute("selected",""),e.innerText=t.display??t.value,e.value=t.value),this.append(e)}}}customElements.define("ui-selectinput",C,{extends:"select"});class K extends v{list;constructor(t,e,i){super(t,e),Array.isArray(this.value)||(this.value=[]);let l=document.createElement("content");this.list=l,this.append(l);let s=document.createElement("select");s.innerHTML="<option selected disabled hidden>Add...</option>"+i.options.map((t=>`<option>${t}</option>`)).join(""),s.addEventListener("change",(()=>{this.value.push(s.value),s.value="Add...",this.renderList()})),this.append(s),this.renderList()}renderList(){this.list.innerHTML="",this.list.append(...this.value.map(((t,e)=>{let i=new tt.Badge(t);return i.append(new tt.Button("",(()=>{this.value.splice(e,1),this.renderList()}),{icon:"fa-times",style:"text",color:"error-color"})),i})))}}customElements.define("ui-multiselectinput",K);class z extends v{constructor(t,e){super(t,e);let i=document.createElement("textarea");i.onkeydown=t=>{if("Tab"==t.key){t.preventDefault();let e=i.selectionStart;this.value=this.value.substring(0,i.selectionStart)+"\t"+this.value.substring(i.selectionEnd),i.selectionEnd=e+1}};let l=()=>{i.style.height="1px",i.style.height=i.scrollHeight+"px"};i.onkeyup=l,i.addEventListener("change",(()=>{try{let t=JSON.parse(i.value);this.value=t,this.classList.toggle("error",!1)}catch(t){this.classList.toggle("error",!0)}})),i.value=JSON.stringify(this.value??"",null,"\t"),this.append(i),setTimeout(l,10)}}customElements.define("ui-json-input",z);class H extends HTMLLabelElement{input;constructor(t,e,{wrapped:i=!1}={}){if(super(),i)this.innerHTML=`<span class="label">${e}</span>`,this.append(t);else{let i=t.id;null==i&&(i="ui-"+Math.random().toString(16).slice(2),t.id=i),this.setAttribute("for",i),this.innerText=e}}get value(){return this.input.value}set value(t){this.input.value=t}}customElements.define("ui-label",H,{extends:"label"});class w extends H{constructor(t,e,i,l){super(new i(t,e,l),l.name??e,{wrapped:!0})}}customElements.define("ui-labelledinput",w,{extends:"label"});class O extends f{json;constructor(t,e,i){super(),this.json=e,this.build(t,e)}build(t,e){console.log("build",t,e);for(let i of Object.keys(t)){let l=t[i];if("function"==typeof l)this.append(new w(e,i,l));else if(Array.isArray(l))this.append(new w(e,i,l[0],l[1]));else{let t=Reflect.get(e,i);null==t&&(t={},Reflect.set(e,i,t)),this.build(l,t)}}}get value(){return this.json}}customElements.define("ui-form2",O);class j{path;pathVariables=[];func;constructor(t,e){for(;t.includes("{");){let e=t.substring(t.indexOf("{"),t.indexOf("}")+1);t=t.replace(e,"([^/]*)"),this.pathVariables.push(j.v(e.substring(1,e.length-1)))}this.path=new RegExp(t),this.func=e}static v(t){let[e,i]=t.split(":");return{name:e,set:(t,l)=>{if(l){switch(i){case"number":l=parseFloat(l);break;case"boolean":l="true"==l.toLowerCase();break;case"json":l=JSON.parse(l)}t[e]=l}}}}async handle(t,e){let i=t.match(this.path);if(!i||i[0].length!=t.length)return!1;let l={};i.shift();for(let t of this.pathVariables)t.set(l,i.shift());return await this.func(l)}}class M extends a{key=null;hash=null;depth=0;eventlistener;handlers=[];position=[0,0];static DIRECTION={NONE:0,LEFT:1,RIGHT:2,BOTTOM:3,TOP:4,RANDOM:100};static Handler=j;constructor(t=null){super(),this.key=t,this.eventlistener=()=>this.hashChange(),window.addEventListener("hashchange",this.eventlistener)}static read(t){let[e,i]=t.split(":"),l=window.location.hash.substring(1).split("|").filter((t=>""!=t)).map((t=>t.includes("=")?t.split("=",2):[null,t])).find((t=>t[0]==e))?.[1];if(l)switch(i){case"number":l=parseFloat(l);break;case"boolean":l="true"==l.toLowerCase();break;case"json":l=JSON.parse(l)}return l}remove(){return super.remove(),window.removeEventListener("hashchange",this.eventlistener),this}get value(){return this.hash}handler(t,e){return this.handlers.push(new j(t,e)),this}addHandler(t){this.handlers.push(t)}set(t){let e=window.location.hash.substring(1).split("|").filter((t=>""!=t)).map((t=>t.includes("=")?t.split("=",2):[null,t])),i=e.find((t=>t[0]==this.key));null==i&&(i=[this.key,null],e.push(i)),i[1]=t,window.location.hash=e.map((t=>t[0]?t.join("="):t[1])).join("|")}async hashChange(){let t=window.location.hash.substring(1).split("|").map((t=>t.includes("=")?t.split("=",2):[null,t])).find((t=>t[0]==this.key));null==t&&(t=[this.key,""]);let e=t[1],i=this.hash;if(this.hash=e,this.hash!=i)for(let t of this.handlers){let l=await t.handle(e,i);if(l){Array.isArray(l)?await this.swapContent(l[0],l[1]):await this.swapContent(l,null);break}}}async swapContent(i,l=M.DIRECTION.RIGHT){let s,n,d=document.createElement("content");if(e(d,i),null==this.firstElementChild)return this.appendChild(d);if(null==l)return this.firstElementChild.remove(),void this.appendChild(d);if(l==M.DIRECTION.RANDOM){let t=[M.DIRECTION.RIGHT,M.DIRECTION.LEFT,M.DIRECTION.TOP,M.DIRECTION.BOTTOM];l=t[Math.floor(Math.random()*t.length)]}if(Array.isArray(l)){console.log(this.position,l);let t=l;l=this.position[0]!=l[0]?this.position[0]>l[0]?M.DIRECTION.LEFT:M.DIRECTION.RIGHT:this.position[1]!=l[1]?this.position[1]<l[1]?M.DIRECTION.BOTTOM:M.DIRECTION.TOP:M.DIRECTION.RIGHT,this.position=t}switch(l){case M.DIRECTION.RIGHT:[s,n]=["right","left"];break;case M.DIRECTION.LEFT:[s,n]=["left","right"];break;case M.DIRECTION.TOP:[s,n]=["top","bottom"];break;case M.DIRECTION.BOTTOM:[s,n]=["bottom","top"]}let a=this.cssNumber("--timing");d.classList.add(s),this.appendChild(d),t(50).then((()=>{d.classList.remove(s),this.firstElementChild.classList.add(n),setTimeout((()=>this.firstElementChild.remove()),a)}))}}customElements.define("ui-hash",M);class E extends N{constructor(t){super(t?"object"==typeof t?JSON.stringify(t,null,"\t"):JSON.stringify(JSON.parse(t),null,"\t"):null)}}customElements.define("ui-json",E);let P=0;class Q extends a{elementMap=new WeakMap;static ASC=!0;static DESC=!1;dirty=!0;_busy=!1;_sort=null;attrs={};listBody=null;_data=null;static ITEMS_COLUMNS_KEY="--item-columns";static ITEMS_PER_PAGE_KEY="--items-per-page";display;lookup;_filterFunc;_itemDisplayFunc;pageNumber;constructor(t,e={}){super(),this.setAttribute("ui-list",""),this.innerHTML=this.listLayout,this.listBody=this.querySelector(".list"),this._sort=null,this._data=[],this.display=[],this.lookup={},this._filterFunc=null,this._itemDisplayFunc=t,this.pageNumber=0,e.itemColumns&&(this.itemColumns=e.itemColumns),e.itemsPerPage&&(this.itemsPerPage=e.itemsPerPage)}async notBusy(){for(;this._busy;)await t(10)}set itemColumns(t){this.setCss(Q.ITEMS_COLUMNS_KEY,t)}get itemsPerPage(){return this.cssNumber(Q.ITEMS_PER_PAGE_KEY)||24}set itemsPerPage(t){this.setCss(Q.ITEMS_PER_PAGE_KEY,t)}get listLayout(){return'\n\t\x3c!-- pagination --\x3e\n\t<header>\n\t\t<span><span class="sort"></span></span>\n\t\t<ui-spacer></ui-spacer>\n\t\t<span class="paging top"></span>\n\t</header>\n\n\t<content class="list">\n\t</content>\n\n\t\x3c!-- pagination --\x3e\n\t<footer>\n\t\t<ui-spacer></ui-spacer>\n\t\t<div class="paging bottom"></div>\n\t</footer>'}set data(t){this._data=t;for(let t of this._data)null==t.__id&&(t.__id=t.id?t.id:""+P++);this.dirty=!0}get data(){return this._data}addAttribute(t,e=(e=>e[t]),i=e,l=null){return this.attrs[t]={id:P++,name:t,width:l,value:"string"==typeof e?t=>t[e]:e,displayFunc:"string"==typeof i?t=>t[i]:i},this.dirty=!0,this}_filtered(t){return null==this._filterFunc||this._filterFunc(t)}filter(t=this._filterFunc){this._filterFunc=t,this.dirty=!0,this.notBusy().then((()=>this.page(0)))}sortDisplay(){let t=this.querySelector(".sort"),e=document.createElement("select");e.innerHTML=Object.values(this.attrs).map((t=>t.value?`<option value="${t.name}:asc" >▲ ${t.name}</option>\n\t\t\t<option value="${t.name}:desc">▼ ${t.name}</option>`:"")).join(""),e.value=this._sort?`${this._sort.attr.name}:${this._sort.asc?"asc":"desc"}`:null,e.onchange=()=>{let t=e.value.split(":");this.sort(t[0],"asc"==t[1])},t.innerHTML="",t.appendChild(e),0==Object.values(this.attrs).length&&(t.style.display="none")}async render(t=!1){t&&(this.dirty=!0),this.sortDisplay(),await this.page()}async sort(t=this._sort?.attr,e=!this._sort?.asc){this.dirty=!0;let i="string"==typeof t?this.attrs[t]:t;this._sort=null==t?null:{attr:i,asc:e},0!=this.data.length&&await this.render()}async page(t=this.pageNumber){await this.notBusy(),this._busy=!0;try{this.dirty&&(this.display=[...this.data],this.display=this.display.filter((t=>this._filtered(t))),this._sort&&(this.display=this.display.sort(((t,e)=>{let i=t?this._sort.attr.value(t):null,l=e?this._sort.attr.value(e):null;if(i==l)return 0;let s=this._sort.asc?1:-1;return null==l?s:null==i?-s:s*(""+i).localeCompare(""+l,"en",{sensitivity:"base",ignorePunctuation:!0,numeric:!0})}))),this.dirty=!1,this.pageNumber=0);let e=this.display.length,i=Math.ceil(e/this.itemsPerPage),l=i>1;if(this.pageNumber=isNaN(t)?0:Math.max(Math.min(t,i-1),0),l){let t=this.pagingMarkup(this.pageNumber,i,e);this.querySelector(".paging.top").innerHTML=t,this.querySelector(".paging.bottom").innerHTML=t,n(...this.querySelectorAll("[data-page]")).forEach((t=>t.addEventListener("click",(()=>{this.page(parseInt(t.dataset.page))}))))}else this.querySelector(".paging.top").innerHTML="",this.querySelector(".paging.bottom").innerHTML="";this.listBody.innerHTML="";for(let t=this.pageNumber*this.itemsPerPage;t<(this.pageNumber+1)*this.itemsPerPage&&t<e;t++){let e=this.display[t],i=await this.getItemElement(e);i instanceof a?i.attach(this.listBody):this.listBody.appendChild(i)}}finally{this._busy=!1}}async getItemElement(t){if(!this.elementMap.has(t)){let e=await this.renderItem(t);if("string"==typeof t)return e;this.elementMap.set(t,e)}return this.elementMap.get(t)}async renderItem(t){return await this._itemDisplayFunc(t)}pagingMarkup(t,e,i){let l="";l+=`${i} items`,l+=`<ui-button data-page="0" class="near ${0==t?"active":""}">1</ui-button>`;let s=t-1,n=t+1+1;s<1&&(n+=1-s,s=1),n>e-1&&(s-=n-e+1,n=e-1,s=Math.max(1,s)),s>1&&(l+="<span>...</span>");for(let e=s;e<n;e++)l+=`<ui-button data-page="${e}" class="${e==t?"active":""}">${e+1}</ui-button>`;return n<e-1&&(l+="<span>...</span>"),l+=`<ui-button data-page="${e-1}" class="near ${t==e-1?"active":""}">${e}</ui-button>`,l}}customElements.define("ui-list",Q);class B extends Q{constructor(t={}){super((async t=>{let i=document.createElement("tr");i.dataset.tableId=t.__id;for(let l of Object.values(this.attrs)){let s=document.createElement("td");e(s,await l.displayFunc(t)),i.append(s)}return i}),t),this.setAttribute("ui-table","")}get listLayout(){return'<table>\n<thead>\n\t\x3c!-- pagination --\x3e\n\t<tr><td class="paging top" colspan="100"></td></tr>\n\n\t<tr class="headers"></tr>\n\t\x3c!-- filters --\x3e\n</thead>\n<tbody class="list">\n</tbody>\n<tfoot>\n\t\x3c!-- pagination --\x3e\n\t<tr><td class="paging bottom" colspan="100"></td></tr>\n</tfoot>\n</table>'}sortDisplay(){let t=this.querySelector("thead tr.headers"),e=Object.values(this.attrs),i="";for(let t of e)i+=`<th data-table-id="${t.id}" ${this.attrs[t.name].value?`data-sort="${t.name}"`:""} style="${t.width?`width:${t.width}`:""}">${t.name}</th>`;t.innerHTML=i,t.querySelectorAll("th").forEach((t=>{t.dataset.sort&&(t.onclick=e=>{this.sort(t.dataset.sort)})})),this._sort&&this.querySelector(`thead tr.headers th[data-table-id='${this._sort.attr.id}']`).classList.add(this._sort.asc?"asc":"desc")}}customElements.define("ui-table",B);class D extends a{constructor(){super()}}customElements.define("ui-spacer",D);class A extends a{constructor(t){super();let e=t?.size??this.attributes.getNamedItem("size")?.value??"1em";this.style.setProperty("--size",e)}}customElements.define("ui-spinner",A);class q extends a{#view={parent:null,x:0,y:0,zoom:1,get width(){return this.parent.bounds.width/this.zoom},get height(){return this.parent.bounds.height/this.zoom}};#lastV;attachments=[];canvas;grid=[{step:1,offset:1,color:"#7772"},{step:6,offset:6,color:"#7772"},{step:12,offset:0,color:"#7774"},{step:1/0,offset:0,color:"#999"}];constructor(){super(),this.#view.parent=this,this.canvas=document.createElement("canvas"),this.append(this.canvas),this.setCss("--pixel",this.#view.zoom)}addAttachment(t,e=!0){this.attachments.push(t),this.append(t),e&&this.updateAttachments()}removeAttachment(t,e=!0){this.attachments=this.attachments.filter((e=>e!=t)),this.removeChild(t),e&&this.updateAttachments()}setCenter(t,e){this.#view.x=t-this.#view.width/2,this.#view.y=e-this.#view.height/2}getCenter(){return this.toView(this.#view.width/2,this.#view.height/2)}setZoom(t,e=null,i=null){if(null==e){let t=this.getCenter();e=t.x,i=t.y}let l=this.toScreen(e,i);this.#view.zoom=t,this.setCss("--pixel",1/this.#view.zoom);let s=this.toScreen(e,i),n=s.x-l.x,d=s.y-l.y;this.panScreen(n,d)}getZoom(){return this.#view.zoom}getView(){return{x:this.#view.x,y:this.#view.y,zoom:this.#view.zoom,width:this.#view.width,height:this.#view.height}}panScreen(t,e){this.#view.x+=t/this.#view.zoom,this.#view.y+=e/this.#view.zoom}toView(t,e){let i=this.#view,l=this.bounds,s={x:(t-l.x)/i.zoom+i.x,y:(e-l.y)/i.zoom+i.y,out:!1};return s.out=s.x<i.x||s.x>i.x+i.width||s.y<i.y||s.y>i.y+i.height,s}toScreen(t,e){let i=this.#view;return{x:(t-i.x)*i.zoom,y:(e-i.y)*i.zoom}}get bounds(){return this.getBoundingClientRect()}render(){let t=this.#view,e=JSON.stringify({x:t.x,y:t.y,w:t.width,h:t.height,z:t.zoom});if(null!=this.#lastV&&this.#lastV==e)return void(this.#lastV=e);this.#lastV=e;let i=this.bounds;this.canvas.width==i.width&&this.canvas.height==i.height||(this.canvas.width=i.width,this.canvas.height=i.height);let l=this.canvas.getContext("2d");if(l.resetTransform(),l.clearRect(0,0,this.canvas.width,this.canvas.height),this.grid.length){let e=-t.x*t.zoom,i=-t.y*t.zoom,s=0,n=t.width*t.zoom,d=0,a=t.height*t.zoom;l.lineWidth=1;for(let c of this.grid)if(!(t.zoom*c.step<10)){l.beginPath(),l.strokeStyle=c.color;for(let u=c.offset??0;u<1e3*c.step;u+=c.step){let c=u*t.zoom;c+i>d&&c+i<a&&(l.moveTo(s,c+i),l.lineTo(n,c+i)),-c+i>d&&-c+i<a&&(l.moveTo(s,-c+i),l.lineTo(n,-c+i)),c+e>s&&c+e<n&&(l.moveTo(c+e,d),l.lineTo(c+e,a)),-c+e>s&&-c+e<n&&(l.moveTo(-c+e,d),l.lineTo(-c+e,a))}l.stroke()}}this.updateAttachments()}updateAttachments(){let t=this.#view;for(let e of this.attachments)if(e.render)e.render(this);else{let i=e.scalar??1,l=(e.x??0)*i-t.x,s=(e.y??0)*i-t.y,n=`translate(${l*t.zoom}px, ${s*t.zoom}px) scale(${t.zoom*i})`;e.style.transform=n}}bindMouse(){let t=null;this.addEventListener("contextmenu",(t=>{t.preventDefault()})),this.addEventListener("wheel",(t=>{let e=this.toView(t.x,t.y),i=Math.exp((480*Math.log(this.#view.zoom)-t.deltaY)/480);this.setZoom(i,e.x,e.y),this.render()})),document.addEventListener("mousedown",(e=>{1==e.button&&(t=[e.x,e.y]),e.button,e.button})),document.addEventListener("mousemove",(e=>{if(t){let i=[e.x,e.y];this.panScreen(t[0]-i[0],t[1]-i[1]),t=i,this.render()}})),document.addEventListener("mouseup",(e=>{if(1==e.button){let i=[e.x,e.y];this.panScreen(t[0]-i[0],t[1]-i[1]),t=null,this.render()}e.button,e.button}))}}customElements.define("ui-viewport",q);let _=[import.meta.url+"/../ui.css","https://fonts.googleapis.com/css2?family=Nunito+Sans:ital,wght@0,200;0,300;0,400;0,600;0,700;0,800;0,900;1,200;1,300;1,400;1,600;1,700;1,800;1,900&display=swap","https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.css"],$=document.createElement("head");$.innerHTML=_.map((t=>`<link href="${t}" rel="stylesheet">`)).join(""),document.head.prepend(...$.childNodes);const tt={BasicElement:a,Badge:y,Button:c,Cancel:L,Card:I,Code:N,ContextMenu:R,Form:h,Form2:O,Grid:f,HashManager:M,InputLabel:H,Json:E,JsonInput:z,LabelledInput:w,List:Q,Modal:o,MultiSelectInput:K,NumberInput:k,Panel:b,SelectInput:C,Spacer:D,Spinner:A,Splash:m,StringInput:g,Table:B,Toast:r,Toggle:u,Viewport:q,info:W,warn:X,error:G,html:s,uuid:l,sleep:t,utils:d,factory:V};window.UI=tt;let et=s;export{y as Badge,a as BasicElement,c as Button,L as Cancel,I as Card,N as Code,R as ContextMenu,h as Form,f as Grid,M as HashManager,H as InputLabel,E as Json,w as LabelledInput,Q as List,o as Modal,K as MultiSelectInput,k as NumberInput,b as Panel,D as Spacer,A as Spinner,m as Splash,g as StringInput,B as Table,r as Toast,u as Toggle,q as Viewport,et as createElement,tt as default,V as factory,d as utils};
